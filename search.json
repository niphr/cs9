[{"path":"https://www.csids.no/cs9/CLAUDE.html","id":null,"dir":"","previous_headings":"","what":"CLAUDE.md","title":"CLAUDE.md","text":"file provides guidance Claude Code (claude.ai/code) working code repository.","code":""},{"path":"https://www.csids.no/cs9/CLAUDE.html","id":"overview","dir":"","previous_headings":"","what":"Overview","title":"CLAUDE.md","text":"CS9 (Core Surveillance 9) free open-source framework real-time analysis disease surveillance. ’s R package provides generic infrastructure implementing surveillance systems database integration, task scheduling, parallel processing capabilities.","code":""},{"path":"https://www.csids.no/cs9/CLAUDE.html","id":"development-commands","dir":"","previous_headings":"","what":"Development Commands","title":"CLAUDE.md","text":"","code":"# Essential R package development workflow devtools::load_all(\".\")              # Load package functions during development devtools::document()                 # Generate documentation   devtools::check()                    # Standard package check R CMD check . --as-cran             # REQUIRED: CRAN compliance check devtools::build()                   # Build package devtools::install()                 # Install package  # Testing testthat::test_dir(\"tests/testthat\") # Run tests"},{"path":[]},{"path":"https://www.csids.no/cs9/CLAUDE.html","id":"core-framework-components","dir":"","previous_headings":"Architecture Overview","what":"Core Framework Components","title":"CLAUDE.md","text":"SurveillanceSystem_v9: main R6 class orchestrates entire surveillance system - Manages database tables, partitioned tables, tasks - Provides shortcuts data access task execution - Located R/r6_SurveillanceSystem.R Task: R6 class representing individual surveillance tasks - Contains plans (data processing units) analyses - Supports parallel execution database operations - Located R/r6_Task.R Database Integration: Extended database table classes surveillance data - DBTableExtended_v9: Enhanced database table management - DBPartitionedTableExtended_v9: Multi-table partitioning support - Automatic logging table updates metadata tracking","code":""},{"path":"https://www.csids.no/cs9/CLAUDE.html","id":"task-development-pattern","dir":"","previous_headings":"Architecture Overview","what":"Task Development Pattern","title":"CLAUDE.md","text":"CS9 follows structured approach implementing surveillance tasks: Schema Definition: Define database table structure, field types, keys, validation Task Configuration: Specify task name, execution parameters, schema mappings Data Selector Function: Extract prepare data analysis Action Function: Core analysis logic processes data stores results","code":""},{"path":"https://www.csids.no/cs9/CLAUDE.html","id":"key-architectural-concepts","dir":"","previous_headings":"Architecture Overview","what":"Key Architectural Concepts","title":"CLAUDE.md","text":"Plans Analyses: Tasks organized plans (data processing units) containing analyses - Plans can run sequentially parallel - plan data selector runs per plan - analysis within plan runs action function Argsets: Named lists containing arguments passed functions - Universal argsets apply plans/analyses - Plan-specific argsets vary plan - Analysis-specific argsets vary analysis Schema System: Comprehensive data validation management - Field type validation (TEXT, INTEGER, DOUBLE, DATE, DATETIME, BOOLEAN) - Content validation data integrity - Access control schema naming (anon, restr, etc.)","code":""},{"path":"https://www.csids.no/cs9/CLAUDE.html","id":"development-workflow-integration","dir":"","previous_headings":"Architecture Overview","what":"Development Workflow Integration","title":"CLAUDE.md","text":"Interactive Development: Use plnr::is_run_directly() blocks interactive testing Task Execution Debugging:","code":"if(plnr::is_run_directly()){   # Development code that only runs when manually executed   # Allows treating functions as interactive scripts   index_plan <- 1   argset <- ss$shortcut_get_argset(\"task_name\", index_plan = index_plan) } # Run specific tasks ss$run_task(\"task_name\")  # Get task overview ss$shortcut_get_plans_argsets_as_dt(\"task_name\")  # Access data for debugging   data <- ss$shortcut_get_data(\"task_name\", index_plan = 1) argset <- ss$shortcut_get_argset(\"task_name\", index_plan = 1, index_analysis = 1)"},{"path":[]},{"path":"https://www.csids.no/cs9/CLAUDE.html","id":"database-operations","dir":"","previous_headings":"Development Best Practices","what":"Database Operations","title":"CLAUDE.md","text":"Use keyby data.table aggregations ensure proper database insertion Apply cstidy::set_csfmt_rts_data_v1() structural data formatting Always validate data database operations","code":""},{"path":"https://www.csids.no/cs9/CLAUDE.html","id":"task-implementation","dir":"","previous_headings":"Development Best Practices","what":"Task Implementation","title":"CLAUDE.md","text":"Place schema definitions designated schema files Use RStudio addins boilerplate code generation Implement data selector action functions task Use mandatory_db_filter() explicit data filtering","code":""},{"path":"https://www.csids.no/cs9/CLAUDE.html","id":"configuration-and-logging","dir":"","previous_headings":"Development Best Practices","what":"Configuration and Logging","title":"CLAUDE.md","text":"Use update_config_log() task execution logging Access configuration get_config_log() debugging Track performance metrics built-configuration tables","code":""},{"path":"https://www.csids.no/cs9/CLAUDE.html","id":"parallel-processing","dir":"","previous_headings":"Development Best Practices","what":"Parallel Processing","title":"CLAUDE.md","text":"Set cores parameter task configuration parallel execution First last plans always run sequentially setup/cleanup Use plnr::expand_list() plan structure definition","code":""},{"path":"https://www.csids.no/cs9/CLAUDE.html","id":"file-structure","dir":"","previous_headings":"","what":"File Structure","title":"CLAUDE.md","text":"framework enables systematic development surveillance systems robust data management, parallel processing capabilities, comprehensive logging epidemiological analysis.","code":"R/                              # Source code ├── r6_SurveillanceSystem.R    # Main surveillance system class ├── r6_Task.R                  # Task management class ├── r6_DBTableExtended_v9.R    # Enhanced database tables ├── config_*.R                 # Configuration management ├── addins.R                   # RStudio addins for development └── util_*.R                   # Utility functions  dev/                           # Development scripts ├── ss_example.R               # Example surveillance system setup └── *.R                        # Other development utilities  vignettes/                     # Documentation ├── cs9.Rmd                    # Main package documentation ├── creating-a-task.Rmd.orig   # Task creation guide └── file-layout.Rmd            # File organization guide  tests/testthat/                # Test suite"},{"path":[]},{"path":"https://www.csids.no/cs9/CLAUDE.html","id":"project-structure-patterns","dir":"","previous_headings":"Implementation Lessons from Real-World Usage","what":"Project Structure Patterns","title":"CLAUDE.md","text":"Standard CS9 Implementation Layout: Critical .onLoad() Sequence:","code":"R/ ├── 00_env_and_namespace.R     # Environment setup and exports ├── 01_definitions.R           # Project-specific definitions ├── 02_surveillance_systems.R  # Initialize surveillance system ├── 03_tables.R               # Database table definitions ├── 04_tasks.R                # Task configuration ├── 05_deliverables.R         # Output/report configuration (optional) ├── 10_onLoad.R               # Package loading sequence ├── 11_onAttach.R             # Package attachment messages └── [task_name].R             # Individual task implementations .onLoad <- function(libname, pkgname) {   # Authentication (if needed)   if (file.exists(\"/bin/authenticate.sh\")) {     try(system2(\"/bin/authenticate.sh\", stdout = NULL), TRUE)   }      # Initialize in correct order   set_definitions()          # Global definitions first   set_surveillance_systems() # Initialize ss object   set_db_tables()           # Add tables to ss   set_tasks()               # Add tasks to ss      # Configure progress bars   progressr::handlers(progressr::handler_progress(     format = \"[:bar] :current/:total (:percent) in :elapsedfull, eta: :eta\",     clear = FALSE   )) }"},{"path":"https://www.csids.no/cs9/CLAUDE.html","id":"advanced-task-patterns","dir":"","previous_headings":"Implementation Lessons from Real-World Usage","what":"Advanced Task Patterns","title":"CLAUDE.md","text":"Pipeline Tasks Dependencies: Real implementations use complex multi-stage pipelines tasks depend outputs previous tasks: Dynamic Plan Generation plan_analysis_fn_name: complex scenarios plans must generated based database state: Historical Context Loading Pattern: Critical pattern temporal calculations (ELO ratings, lag features): Plan Analysis: Identify new data process Load batch data process Extract unique participants batch Load complete historical context participants Action: Use historical context accurate calculations, insert batch results","code":"# Pattern: Data processing pipeline betting_upload_raw_data → anon_betting_raw_data          ↓ betting_calculate_elos → anon_betting_runner_elos + anon_betting_jockey_elos          ↓                                    ↓ betting_clean_basic_data → anon_betting_basic_clean_data          ↓                                    ↓   betting_merge_clean_data ← anon_betting_runner_elos + anon_betting_jockey_elos          ↓ betting_summarize_data → validation reports + anon_betting_data_summary # Task configuration using plan_analysis function global$ss$add_task(   name_grouping = \"betting\",   name_action = \"calculate\",    name_variant = \"elos\",   plan_analysis_fn_name = \"horses::betting_calculate_elos_plan_analysis\",   for_each_plan = NULL,  # Generated dynamically   for_each_analysis = NULL,  # Generated dynamically   universal_argset = list(batch_size = 30000),   # ... rest of configuration )"},{"path":"https://www.csids.no/cs9/CLAUDE.html","id":"database-schema-best-practices","dir":"","previous_headings":"Implementation Lessons from Real-World Usage","what":"Database Schema Best Practices","title":"CLAUDE.md","text":"Complex Field Types Real Implementation: Multi-Purpose Database Indexes:","code":"field_types = c(   # Standard identifiers   \"race_id\" = \"TEXT\",   \"runner_id\" = \"TEXT\",    \"meeting_date\" = \"DATE\",      # Calculated features with proper types   \"runner_elo_before\" = \"DOUBLE\",   \"forecast_price_decimal\" = \"DOUBLE\",    \"is_win\" = \"INTEGER\",             # Boolean as INTEGER   \"data_split\" = \"TEXT\",            # train/validation/holdout      # Lag features (systematic naming)   \"lag1_finish_position\" = \"INTEGER\",   \"lag2_finish_position\" = \"INTEGER\",   \"lag3_finish_position\" = \"INTEGER\",   \"lag4_finish_position\" = \"INTEGER\",      # Race-relative features   \"runner_elo_vs_race_avg\" = \"DOUBLE\",   \"odds_rank_in_race\" = \"INTEGER\" ) indexes = list(   \"ind1\" = c(\"race_id\", \"runner_id\"),      # Primary lookup   \"ind2\" = c(\"meeting_date\"),              # Temporal queries   \"ind3\" = c(\"runner_id\", \"meeting_date\"), # Historical lookups   \"ind4\" = c(\"calculation_date\")           # Processing tracking )"},{"path":"https://www.csids.no/cs9/CLAUDE.html","id":"robust-data-validation-patterns","dir":"","previous_headings":"Implementation Lessons from Real-World Usage","what":"Robust Data Validation Patterns","title":"CLAUDE.md","text":"Multi-Part Analysis Structure: Real implementations use systematic 4-part validation: Database Compliance Aggregation:","code":"# Part 1: Processing Progress by Year year_progress <- raw_data[, .(raw_records = .N), by = .(year = year(meeting_date), data_split)]  # Part 2: Data Validation (Same Time Ranges)   validation_metrics <- merge(raw_metrics, clean_metrics, by = \"data_split\")  # Part 3: Variable Quality Analysis missing_analysis <- clean_data[, lapply(.SD, function(x) sum(is.na(x))/.N*100)]  # Part 4: Final Dataset Characteristics modeling_readiness <- clean_data[, .N, by = complete.cases(.SD)] # CRITICAL: Always use keyby with required key fields summary_results <- clean_data[, .(   metric_value = mean(some_metric),   metric_text = paste(\"Summary text\") ), keyby = data_split]  # Ensures data_split key compliance  # Multi-key tables summary_table <- data[, .(   value = calculation ), keyby = .(summary_type, metric_name, data_split)]"},{"path":"https://www.csids.no/cs9/CLAUDE.html","id":"production-deployment-considerations","dir":"","previous_headings":"Implementation Lessons from Real-World Usage","what":"Production Deployment Considerations","title":"CLAUDE.md","text":"Docker Integration: Real implementations integrate Docker-based infrastructure: - Airflow task scheduling (0 2 * * * daily schedules) - Posit Workbench development (port 8786) - PostgreSQL databases data storage Error Handling Patterns: Incremental Processing: Production systems process data incrementally: - Use date-based filtering avoid reprocessing - Maintain calculation_date fields tracking - Implement proper upsert patterns updates","code":"# Robust error handling in action functions if(length(current_race_id) == 0 || is.na(current_race_id)) {   return()  # Graceful exit for empty data }  if(nrow(current_race) < 2) {   return()  # Skip invalid races }  # Use tryCatch for complex calculations result <- tryCatch({   complex_calculation() }, error = function(e) {   cat(\"Error in calculation:\", e$message, \"\\n\")   return(NULL) })"},{"path":"https://www.csids.no/cs9/CLAUDE.html","id":"documentation-standards-for-production","dir":"","previous_headings":"Implementation Lessons from Real-World Usage","what":"Documentation Standards for Production","title":"CLAUDE.md","text":"Comprehensive Task Documentation: real-world usage demonstrates CS9’s capabilities complex data processing pipelines robust validation, temporal calculations, production deployment patterns.","code":"#' Task Name (action) #' #' Detailed description of what this task does in the pipeline context. #' #' @param data Named list containing input datasets #' @param argset Named list containing analysis parameters   #' @param tables Named list of database table connections #' @return NULL (side effect: inserts data into database) #' @details #' Task's role in pipeline dependency chain: #' \\itemize{   #'   \\item Input: Expected table schemas and their purpose #'   \\item Processing: Key data transformations performed #'   \\item Output: Generated table schemas and contents #'   \\item Dependencies: Relationship to other pipeline stages #' } #' @export"},{"path":[]},{"path":"https://www.csids.no/cs9/CLAUDE.html","id":"package-distribution-strategy","dir":"","previous_headings":"CRAN Deployment Considerations","what":"Package Distribution Strategy","title":"CLAUDE.md","text":"Infrastructure Requirements vs CRAN Compatibility CS9 fundamentally designed database-driven surveillance systems, creates unique challenges CRAN distribution: Core Architecture: Requires PostgreSQL/MariaDB backend full functionality CRAN Environment: Minimal, external database connections available Solution: Graceful degradation approach clear user guidance","code":""},{"path":"https://www.csids.no/cs9/CLAUDE.html","id":"environment-configuration-best-practices","dir":"","previous_headings":"CRAN Deployment Considerations","what":"Environment Configuration Best Practices","title":"CLAUDE.md","text":"Robust .onLoad() Implementation Key Patterns: - Modular setup: Separate environment database initialization - Error isolation: Use tryCatch setup phase - User guidance: Provide clear next steps setup fails - Diagnostic tools: Include check_environment_setup() function","code":".onLoad <- function(libname, pkgname) {   # Phase 1: Environment variable setup with error handling   env_result <- tryCatch({     set_env_vars()     TRUE   }, error = function(e) {     packageStartupMessage(\"Warning: Environment setup failed: \", e$message)     FALSE   })      # Phase 2: Database setup (only if environment configured)   if(!env_result || length(config$dbconfigs) == 0){     packageStartupMessage(\"CS9 database configuration not available. Package loaded with limited functionality.\")     packageStartupMessage(\"Use cs9::check_environment_setup() to diagnose configuration issues.\")   } else {     # Attempt database connection with graceful failure     db_result <- tryCatch({       setup_database_tables()       TRUE     }, error = function(e) {       packageStartupMessage(\"Warning: Database table setup failed: \", e$message)       packageStartupMessage(\"CS9 loaded with limited functionality.\")       FALSE     })   } }"},{"path":"https://www.csids.no/cs9/CLAUDE.html","id":"required-environment-variables","dir":"","previous_headings":"CRAN Deployment Considerations","what":"Required Environment Variables","title":"CLAUDE.md","text":"Database Configuration","code":"# Essential variables for CS9 operation CS9_DBCONFIG_ACCESS=\"config/anon/restr\" CS9_DBCONFIG_DRIVER=\"PostgreSQL\" CS9_DBCONFIG_SERVER=\"localhost\" CS9_DBCONFIG_USER=\"username\" CS9_DBCONFIG_PASSWORD=\"password\"  # Schema-specific configuration CS9_DBCONFIG_SCHEMA_CONFIG=\"schema_name\"   CS9_DBCONFIG_DB_CONFIG=\"database_name\"  # Optional variables with defaults CS9_PATH=\"\"                    # Defaults to empty string CS9_AUTO=\"0\"                   # Defaults to FALSE"},{"path":"https://www.csids.no/cs9/CLAUDE.html","id":"testing-strategy-for-cran","dir":"","previous_headings":"CRAN Deployment Considerations","what":"Testing Strategy for CRAN","title":"CLAUDE.md","text":"Traditional Tests Approach - Removed: /tests/ directory entirely CRAN submission - Rationale: Database infrastructure mocked CRAN environment - Alternative: Comprehensive documentation \\dontrun{} examples - Local testing: Use devtools::load_all() development environment Documentation Testing","code":"# Examples that work in CRAN environment (no database) #' @examples #' \\dontrun{ #' # Requires database configuration #' ss <- cs9::SurveillanceSystem_v9$new() #' ss$add_table(...) #' } #'  #' # Simple examples that work without database #' cs9::check_environment_setup()"},{"path":"https://www.csids.no/cs9/CLAUDE.html","id":"user-setup-guidance","dir":"","previous_headings":"CRAN Deployment Considerations","what":"User Setup Guidance","title":"CLAUDE.md","text":"Installation Instructions Users need clear guidance post-installation setup: Database Setup: PostgreSQL/MariaDB instance required Environment Variables: Set CS9_DBCONFIG_* variables Verification: Use cs9::check_environment_setup() Troubleshooting: Clear error messages guide configuration Diagnostic Function Pattern","code":"#' Check Environment Setup #' @export check_environment_setup <- function() {   # Check required environment variables   # Validate database configuration   # Test database connectivity   # Provide actionable recommendations   # Return structured results }"},{"path":"https://www.csids.no/cs9/CLAUDE.html","id":"version-control-best-practices","dir":"","previous_headings":"CRAN Deployment Considerations","what":"Version Control Best Practices","title":"CLAUDE.md","text":"Build Artifact Management - Never commit: ..Rcheck/ directories R CMD check - Git hygiene: Use git status commits - Cleanup workflow: git reset --soft HEAD~1 fix commits CRAN Submission Branches - Main branch: Essential CRAN requirements - Feature branches: Optional robustness improvements - Clean separation: Must-vs nice--changes approach ensures CS9 can distributed via CRAN maintaining core database-driven architecture providing clear guidance users setting full surveillance infrastructure.","code":""},{"path":"https://www.csids.no/cs9/articles/creating-a-task.html","id":"creating-a-surveillance-task-with-cs9","dir":"Articles","previous_headings":"","what":"Creating a Surveillance Task with CS9","title":"Creating a task","text":"vignette demonstrates create configure surveillance tasks using CS9 framework. CS9 provides structured approach building real-time surveillance systems database integration automated pipeline execution.","code":""},{"path":"https://www.csids.no/cs9/articles/creating-a-task.html","id":"overview","dir":"Articles","previous_headings":"Creating a Surveillance Task with CS9","what":"Overview","title":"Creating a task","text":"Creating surveillance task CS9 involves three main steps: Define database tables schemas describe data structure Configure surveillance tasks specify data processing workflows Implement task functions perform actual data analysis","code":""},{"path":"https://www.csids.no/cs9/articles/creating-a-task.html","id":"prerequisites","dir":"Articles","previous_headings":"Creating a Surveillance Task with CS9","what":"Prerequisites","title":"Creating a task","text":"starting tutorial, need CS9 properly installed configured. See vignette(\"installation\") complete setup instructions including database configuration environment variables. can verify setup working : overview CS9 concepts architecture, see vignette(\"cs9\").","code":"# Check if CS9 environment is properly configured cs9::check_environment_setup()"},{"path":"https://www.csids.no/cs9/articles/creating-a-task.html","id":"step-1-initialize-a-surveillance-system","dir":"Articles","previous_headings":"Creating a Surveillance Task with CS9","what":"Step 1: Initialize a Surveillance System","title":"Creating a task","text":"First, create surveillance system instance manage tables tasks:","code":"# Create a surveillance system library(cs9)  # Initialize the surveillance system ss <- cs9::SurveillanceSystem_v9$new(   name = \"example_surveillance\",   implementation_version = \"1.0.0\" )  # Verify the system was created print(ss$name) print(ss$implementation_version)"},{"path":"https://www.csids.no/cs9/articles/creating-a-task.html","id":"step-2-define-database-tables","dir":"Articles","previous_headings":"Creating a Surveillance Task with CS9","what":"Step 2: Define Database Tables","title":"Creating a task","text":"creating tasks, need define database tables store data. Tables CS9 require: Field types: Column names data types Keys: Columns uniquely identify records Access level: Database access permissions","code":"# Define a table for weather data ss$add_table(   name_access = \"anon\",           # Anonymous access level   name_grouping = \"weather\",      # Data category   name_variant = \"daily_data\",    # Specific variant   field_types = c(     # Temporal fields     \"date\" = \"DATE\",     \"year\" = \"INTEGER\",      \"month\" = \"INTEGER\",     \"day\" = \"INTEGER\",          # Geographic fields     \"location_code\" = \"TEXT\",     \"location_name\" = \"TEXT\",          # Weather measurements     \"temperature_max\" = \"DOUBLE\",     \"temperature_min\" = \"DOUBLE\",      \"precipitation\" = \"DOUBLE\",     \"humidity\" = \"DOUBLE\"   ),   keys = c(\"date\", \"location_code\"),  # Unique identifier   indexes = list(     \"idx_date\" = \"date\",     \"idx_location\" = \"location_code\",      \"idx_date_location\" = c(\"date\", \"location_code\")   ) )  # Define a table for processed results ss$add_table(   name_access = \"anon\",   name_grouping = \"weather\",    name_variant = \"weekly_summary\",   field_types = c(     \"year_week\" = \"TEXT\",     \"location_code\" = \"TEXT\",     \"avg_temp_max\" = \"DOUBLE\",     \"avg_temp_min\" = \"DOUBLE\",     \"total_precipitation\" = \"DOUBLE\",     \"data_quality_score\" = \"DOUBLE\"   ),   keys = c(\"year_week\", \"location_code\") )  # Check which tables are available print(\"Available tables:\") print(names(ss$tables))"},{"path":"https://www.csids.no/cs9/articles/creating-a-task.html","id":"step-3-implement-task-functions","dir":"Articles","previous_headings":"Creating a Surveillance Task with CS9","what":"Step 3: Implement Task Functions","title":"Creating a task","text":"CS9 tasks require two main functions: Data selector function: Extracts prepares data analysis Action function: Performs core analysis stores results","code":""},{"path":"https://www.csids.no/cs9/articles/creating-a-task.html","id":"data-selector-function","dir":"Articles","previous_headings":"Creating a Surveillance Task with CS9 > Step 3: Implement Task Functions","what":"Data Selector Function","title":"Creating a task","text":"data selector function retrieves data needed analysis:","code":"# Data selector function for weather processing weather_data_selector <- function(argset, tables) {   # In a real implementation, this would query your database   # For demonstration, we'll create sample data      sample_data <- data.table::data.table(     date = seq.Date(       from = as.Date(argset$date_from),       to = as.Date(argset$date_to),        by = \"day\"     ),     location_code = rep(argset$location_code,                         length.out = as.numeric(as.Date(argset$date_to) - as.Date(argset$date_from)) + 1),     temperature_max = rnorm(as.numeric(as.Date(argset$date_to) - as.Date(argset$date_from)) + 1,                             mean = 20, sd = 8),     temperature_min = rnorm(as.numeric(as.Date(argset$date_to) - as.Date(argset$date_from)) + 1,                             mean = 10, sd = 5),     precipitation = rgamma(as.numeric(as.Date(argset$date_to) - as.Date(argset$date_from)) + 1,                            shape = 2, rate = 4)   )      # Add derived fields   sample_data[, year := as.integer(format(date, \"%Y\"))]   sample_data[, month := as.integer(format(date, \"%m\"))]   sample_data[, day := as.integer(format(date, \"%d\"))]   sample_data[, location_name := paste(\"Location\", location_code)]   sample_data[, humidity := runif(.N, 30, 90)]      return(list(     data = sample_data   )) }"},{"path":"https://www.csids.no/cs9/articles/creating-a-task.html","id":"action-function","dir":"Articles","previous_headings":"Creating a Surveillance Task with CS9 > Step 3: Implement Task Functions","what":"Action Function","title":"Creating a task","text":"action function performs main analysis:","code":"# Action function for weather processing weather_action <- function(data, argset, tables) {   # Process the daily weather data into weekly summaries      # Add week information   data$data[, year_week := format(date, \"%Y-W%U\")]      # Calculate weekly aggregates   weekly_summary <- data$data[, .(     avg_temp_max = mean(temperature_max, na.rm = TRUE),     avg_temp_min = mean(temperature_min, na.rm = TRUE),      total_precipitation = sum(precipitation, na.rm = TRUE),     data_quality_score = 1.0 - sum(is.na(temperature_max) | is.na(temperature_min)) / .N   ), by = .(year_week, location_code)]      # Insert results into database table   # In a real implementation, this would use:   # tables$anon_weather_weekly_summary$upsert_data(weekly_summary)      # For demonstration, just print results   cat(\"Processed weekly weather summary:\\n\")   print(weekly_summary)      # Log successful completion   cs9::update_config_log(     ss = argset$surveillance_system,     task = \"weather_process_weekly\",      paste(\"Successfully processed\", nrow(weekly_summary), \"weekly records for\", argset$location_code)   ) }"},{"path":"https://www.csids.no/cs9/articles/creating-a-task.html","id":"step-4-configure-the-surveillance-task","dir":"Articles","previous_headings":"Creating a Surveillance Task with CS9","what":"Step 4: Configure the Surveillance Task","title":"Creating a task","text":"Now configure task execution parameters:","code":"# Add the weather processing task ss$add_task(   name_grouping = \"weather\",   name_action = \"process\",    name_variant = \"weekly_summary\",   cores = 1,                              # Single core execution   permission = NULL,                      # No special permissions needed      # Task structure - one plan per location per month   for_each_plan = list(     location_code = c(\"LOC001\", \"LOC002\", \"LOC003\"),     date_from = c(\"2024-01-01\", \"2024-02-01\", \"2024-03-01\"),       date_to = c(\"2024-01-31\", \"2024-02-28\", \"2024-03-31\")   ),      # No analysis-level iteration needed   for_each_analysis = NULL,      # Common arguments for all plans     universal_argset = list(     surveillance_system = \"example_surveillance\",     data_format = \"cs9_standard\"   ),      # Automatically insert results at end of each plan   upsert_at_end_of_each_plan = TRUE,   insert_at_end_of_each_plan = FALSE,      # Function names   action_fn_name = \"weather_action\",   data_selector_fn_name = \"weather_data_selector\",      # Table mapping   tables = list(     weather_daily = \"anon_weather_daily_data\",      weather_weekly = \"anon_weather_weekly_summary\"   ) )  # Verify the task was added print(\"Available tasks:\") print(names(ss$tasks))"},{"path":"https://www.csids.no/cs9/articles/creating-a-task.html","id":"step-5-execute-the-task","dir":"Articles","previous_headings":"Creating a Surveillance Task with CS9","what":"Step 5: Execute the Task","title":"Creating a task","text":"configured, can run surveillance task:","code":"# Get task information task_name <- \"weather_process_weekly_summary\"  # View task plans and analyses if(task_name %in% names(ss$tasks)) {   plans_info <- ss$shortcut_get_plans_argsets_as_dt(task_name)   cat(\"Task execution plans:\\n\")   print(plans_info)      # Run the task   cat(\"\\nExecuting surveillance task...\\n\")   ss$run_task(task_name)      # Check task completion status   task_stats <- cs9::get_config_tasks_stats(task = task_name, last_run = TRUE)   if(nrow(task_stats) > 0) {     cat(\"\\nTask execution completed successfully!\\n\")     print(task_stats[, .(task, datetime, status)])   } }"},{"path":"https://www.csids.no/cs9/articles/creating-a-task.html","id":"step-6-monitor-and-debug-tasks","dir":"Articles","previous_headings":"Creating a Surveillance Task with CS9","what":"Step 6: Monitor and Debug Tasks","title":"Creating a task","text":"CS9 provides several utilities monitoring task execution:","code":"# Get all available tables cat(\"All surveillance system tables:\\n\") print(names(ss$tables))  # Get task execution logs   recent_logs <- cs9::get_config_log(   task = \"weather_process_weekly\",   start_date = Sys.Date() - 7 ) if(nrow(recent_logs) > 0) {   cat(\"\\nRecent task logs:\\n\")    print(recent_logs[, .(datetime, task, message)]) }  # Get task performance statistics task_performance <- cs9::get_config_tasks_stats(last_run = TRUE) if(nrow(task_performance) > 0) {   cat(\"\\nTask performance summary:\\n\")   print(task_performance[, .(task, datetime, runtime_seconds, status)]) }  # Access data for a specific plan (for debugging) if(task_name %in% names(ss$tasks)) {   # Get data for first plan   debug_data <- ss$shortcut_get_data(task_name, index_plan = 1)   cat(\"\\nData structure for plan 1:\\n\")   if(!is.null(debug_data$data)) {     print(str(debug_data$data))   }      # Get arguments for first plan, first analysis   debug_args <- ss$shortcut_get_argset(task_name, index_plan = 1, index_analysis = 1)   cat(\"\\nArgument set for plan 1, analysis 1:\\n\")   print(debug_args) }"},{"path":[]},{"path":"https://www.csids.no/cs9/articles/creating-a-task.html","id":"parallel-processing","dir":"Articles","previous_headings":"Creating a Surveillance Task with CS9 > Advanced Task Features","what":"Parallel Processing","title":"Creating a task","text":"computationally intensive tasks, can enable parallel processing:","code":"# Configure a task for parallel execution ss$add_task(   name_grouping = \"weather\",   name_action = \"analyze\",   name_variant = \"trends\",    cores = 4,  # Use 4 CPU cores      # Large number of plans that can benefit from parallelization   for_each_plan = list(     location_code = sprintf(\"LOC%03d\", 1:100),  # 100 locations     analysis_year = rep(2020:2024, length.out = 100)  # 5 years   ),      universal_argset = list(     min_data_quality = 0.8,     trend_method = \"linear_regression\"   ),      action_fn_name = \"weather_trend_action\",   data_selector_fn_name = \"weather_trend_data_selector\",      tables = list(     input_data = \"anon_weather_daily_data\",     trend_results = \"anon_weather_trends\"   ) )"},{"path":"https://www.csids.no/cs9/articles/creating-a-task.html","id":"custom-plan-generation","dir":"Articles","previous_headings":"Creating a Surveillance Task with CS9 > Advanced Task Features","what":"Custom Plan Generation","title":"Creating a task","text":"complex scenarios, can use function generate plans dynamically:","code":"# Function to generate plans based on database state generate_weather_plans <- function() {   # In real implementation, query database for available data   available_locations <- c(\"LOC001\", \"LOC002\", \"LOC003\")   available_years <- 2020:2024      # Generate plans for locations with sufficient data   plans <- list()   for(location in available_locations) {     for(year in available_years) {       plans <- append(plans, list(list(         location_code = location,         year = year,         min_date = paste0(year, \"-01-01\"),         max_date = paste0(year, \"-12-31\")       )))     }   }      return(list(     for_each_plan = plans,     for_each_analysis = NULL   )) }  # Use the custom plan generator ss$add_task(   name_grouping = \"weather\",   name_action = \"validate\",    name_variant = \"data_quality\",   cores = 2,      # Use function to generate plans   plan_analysis_fn_name = \"generate_weather_plans\",   for_each_plan = NULL,  # Will be generated by function   for_each_analysis = NULL,      universal_argset = list(     quality_threshold = 0.85,     validation_rules = c(\"completeness\", \"consistency\", \"accuracy\")   ),      action_fn_name = \"weather_validation_action\",   data_selector_fn_name = \"weather_validation_data_selector\",       tables = list(     source_data = \"anon_weather_daily_data\",     validation_results = \"anon_weather_validation\"   ) )"},{"path":[]},{"path":"https://www.csids.no/cs9/articles/creating-a-task.html","id":"error-handling","dir":"Articles","previous_headings":"Creating a Surveillance Task with CS9 > Best Practices","what":"1. Error Handling","title":"Creating a task","text":"Always include robust error handling task functions:","code":"robust_weather_action <- function(data, argset, tables) {   tryCatch({     # Validate input data     if(is.null(data$data) || nrow(data$data) == 0) {       warning(\"No data available for processing\")       return(invisible(NULL))     }          # Check required columns     required_cols <- c(\"date\", \"location_code\", \"temperature_max\")     missing_cols <- setdiff(required_cols, names(data$data))     if(length(missing_cols) > 0) {       stop(\"Missing required columns: \", paste(missing_cols, collapse = \", \"))     }          # Perform analysis with validation     result <- data$data[, .(       avg_temp = mean(temperature_max, na.rm = TRUE),       record_count = .N     ), by = location_code]          # Validate results before storing     if(any(is.na(result$avg_temp))) {       warning(\"Some temperature averages could not be calculated\")     }          # Log successful completion     cs9::update_config_log(       ss = argset$surveillance_system,       task = \"weather_analysis\",       paste(\"Successfully processed\", nrow(result), \"location summaries\")     )        }, error = function(e) {     # Log errors for debugging     cs9::update_config_log(       ss = argset$surveillance_system,        task = \"weather_analysis\",       paste(\"ERROR:\", e$message)     )     stop(e)   }) }"},{"path":"https://www.csids.no/cs9/articles/creating-a-task.html","id":"data-validation","dir":"Articles","previous_headings":"Creating a Surveillance Task with CS9 > Best Practices","what":"2. Data Validation","title":"Creating a task","text":"Implement comprehensive data validation:","code":"validate_weather_data <- function(data) {   validation_results <- list()      # Check data completeness   completeness <- data[, lapply(.SD, function(x) sum(!is.na(x))/.N)]   validation_results$completeness <- completeness      # Check data ranges   temp_range_check <- data[temperature_max < -50 | temperature_max > 60, .N]   validation_results$temperature_outliers <- temp_range_check      # Check temporal consistency   date_gaps <- data[order(date), .(     max_gap = max(as.numeric(diff(date)), na.rm = TRUE)   ), by = location_code]   validation_results$temporal_gaps <- date_gaps      return(validation_results) }"},{"path":"https://www.csids.no/cs9/articles/creating-a-task.html","id":"modular-design","dir":"Articles","previous_headings":"Creating a Surveillance Task with CS9 > Best Practices","what":"3. Modular Design","title":"Creating a task","text":"Structure task functions reusability:","code":"# Utility function for common data transformations standardize_weather_data <- function(data) {   # Apply common transformations   data[, temperature_celsius := round(temperature_max, 1)]   data[, date_formatted := format(date, \"%Y-%m-%d\")]   data[, is_weekend := weekdays(date) %in% c(\"Saturday\", \"Sunday\")]      return(data) }  # Reusable data selector template create_weather_data_selector <- function(date_column = \"date\",                                         location_column = \"location_code\") {   function(argset, tables) {     # Common data selection logic     query_data <- tables[[argset$source_table]]$tbl() %>%       dplyr::filter(         !!rlang::sym(date_column) >= argset$date_from,         !!rlang::sym(date_column) <= argset$date_to,         !!rlang::sym(location_column) %in% argset$location_codes       ) %>%       dplyr::collect() %>%       data.table::as.data.table()          # Apply standardization     standardized_data <- standardize_weather_data(query_data)          return(list(data = standardized_data))   } }"},{"path":"https://www.csids.no/cs9/articles/creating-a-task.html","id":"summary","dir":"Articles","previous_headings":"Creating a Surveillance Task with CS9","what":"Summary","title":"Creating a task","text":"vignette covered complete workflow creating surveillance tasks CS9: System Setup: Initialize surveillance system check environment Table Definition: Define database schemas storing data Function Implementation: Create data selector action functions Task Configuration: Set task parameters execution structure Task Execution: Run tasks monitor performance Advanced Features: Parallel processing custom plan generation CS9 framework provides robust foundation building scalable surveillance systems automated pipeline execution, comprehensive logging, flexible task orchestration.","code":""},{"path":"https://www.csids.no/cs9/articles/creating-a-task.html","id":"related-documentation","dir":"Articles","previous_headings":"Creating a Surveillance Task with CS9","what":"Related Documentation","title":"Creating a task","text":"information CS9: vignette(\"cs9\") - Package overview architecture concepts vignette(\"installation\") - Complete installation setup guide vignette(\"file-layout\") - Package structure file organization patterns ?SurveillanceSystem_v9 - Main surveillance system class documentation ?check_environment_setup - Environment configuration diagnostics","code":""},{"path":"https://www.csids.no/cs9/articles/cs9.html","id":"what-is-cs9","dir":"Articles","previous_headings":"","what":"What is CS9?","title":"Introduction to CS9","text":"Core Surveillance 9 (CS9) comprehensive R framework designed building real-time disease surveillance systems. provides infrastructure needed : Real-time data processing: Automated pipelines surveillance data Database-driven workflows: Robust data storage retrieval Task scheduling: Parallel processing workflow orchestration Epidemiological analysis: Built-support surveillance concepts Production deployment: Docker-ready infrastructure operational systems CS9 particularly suited public health organizations, epidemiologists, researchers need process surveillance data systematically reliably.","code":""},{"path":"https://www.csids.no/cs9/articles/cs9.html","id":"when-should-you-use-cs9","dir":"Articles","previous_headings":"","what":"When should you use CS9?","title":"Introduction to CS9","text":"CS9 ideal need : Process surveillance data regular schedule (daily, weekly) Maintain historical data proper database management Run complex analysis pipelines dependencies tasks Deploy surveillance systems production environments Handle multiple data sources analysis outputs Ensure data validation quality control","code":""},{"path":[]},{"path":"https://www.csids.no/cs9/articles/cs9.html","id":"surveillance-system-architecture","dir":"Articles","previous_headings":"","what":"Surveillance system architecture","title":"Introduction to CS9","text":"CS9 organizes surveillance work around hierarchical structure: Tasks → Plans → Analyses Tasks: fundamental unit work - things like “download weather data”, “calculate disease trends”, “generate reports” Plans: Data processing units within tasks - typically organized time periods, geographic areas, data subsets Analyses: Individual computations within plans - actual analytical work performed data","code":""},{"path":"https://www.csids.no/cs9/articles/cs9.html","id":"example-workflow","dir":"Articles","previous_headings":"Surveillance system architecture","what":"Example workflow","title":"Introduction to CS9","text":"typical CS9 surveillance system might include: Data Import Task: Download data external APIs files Data Cleaning Task: Validate, standardize, quality-check incoming data Analysis Task: Calculate surveillance indicators, trends, alerts Reporting Task: Generate outputs like Excel files, plots, automated reports Delivery Task: Send results via email, upload websites, trigger alerts Figure 1. general task showing many options task. Figure 1 shows us full potential task. Data can read sources, within plan data extracted data_selector_fn (.e. “one data-pull”). data provided analysis, run action_fn : provided data provided argset provided tables action_fn can : Write data/results db tables Send emails Export graphs, excel files, reports, physical files Typically subset done single task.","code":""},{"path":"https://www.csids.no/cs9/articles/cs9.html","id":"plan-heavy-or-analysis-heavy-tasks","dir":"Articles","previous_headings":"Surveillance system architecture","what":"Plan-heavy or analysis-heavy tasks?","title":"Introduction to CS9","text":"plan-heavy task one many plans analyses per plan. analysis-heavy task one plans many analyses per plan. general, data-pull slow wastes time. means preferable reduce number data-pulls performed data-pull extract larger quantities data. analysis can subset data required (identifed via argsets). .e. possible, analysis-heavy task preferable faster (cost needing RAM). Obviously, plan’s data-pull larger, use RAM. need conserve RAM, use plan-heavy approach. Figure 1 shows 2 location based analyses, reality 356 municipalities Norway 2021. figure 1 2 plans (1 2021 data, 1 2020 data) 356 analyses plan (1 location_code) taking analysis-heavy approach.","code":""},{"path":"https://www.csids.no/cs9/articles/cs9.html","id":"getting-started-with-cs9","dir":"Articles","previous_headings":"","what":"Getting Started with CS9","title":"Introduction to CS9","text":"Now understand CS9’s architecture concepts, ’re ready start using : Installation Setup: See vignette(\"installation\") complete installation instructions, database configuration, environment setup Package Structure: See vignette(\"file-layout\") detailed guidance organizing CS9 implementation files Creating Tasks: See vignette(\"creating--task\") step--step tutorial implementing first surveillance task","code":""},{"path":"https://www.csids.no/cs9/articles/cs9.html","id":"example","dir":"Articles","previous_headings":"","what":"Example","title":"Introduction to CS9","text":"now go example person design implement weather surveillance task.","code":""},{"path":"https://www.csids.no/cs9/articles/cs9.html","id":"surveillance-system-setup","dir":"Articles","previous_headings":"Example","what":"Surveillance system setup","title":"Introduction to CS9","text":"begin creating surveillance system. hub coordinates everything.","code":"ss <- cs9::SurveillanceSystem_v9$new()"},{"path":"https://www.csids.no/cs9/articles/cs9.html","id":"database-table-definition","dir":"Articles","previous_headings":"Example","what":"Database table definition","title":"Introduction to CS9","text":"documented detail , create database table fits needs (recording weather data), add surveillance system.","code":"ss$add_table(   name_access = c(\"anon\"),   name_grouping = \"example_weather\",   name_variant = NULL,   field_types =  c(     \"granularity_time\" = \"TEXT\",     \"granularity_geo\" = \"TEXT\",     \"country_iso3\" = \"TEXT\",     \"location_code\" = \"TEXT\",     \"border\" = \"INTEGER\",     \"age\" = \"TEXT\",     \"sex\" = \"TEXT\",      \"isoyear\" = \"INTEGER\",     \"isoweek\" = \"INTEGER\",     \"isoyearweek\" = \"TEXT\",     \"season\" = \"TEXT\",     \"seasonweek\" = \"DOUBLE\",      \"calyear\" = \"INTEGER\",     \"calmonth\" = \"INTEGER\",     \"calyearmonth\" = \"TEXT\",      \"date\" = \"DATE\",      \"tg\" = \"DOUBLE\",     \"tx\" = \"DOUBLE\",     \"tn\" = \"DOUBLE\"   ),   keys = c(     \"granularity_time\",     \"location_code\",     \"date\",     \"age\",     \"sex\"   ),   validator_field_types = csdb::validator_field_types_csfmt_rts_data_v1,   validator_field_contents = csdb::validator_field_contents_csfmt_rts_data_v1 )"},{"path":"https://www.csids.no/cs9/articles/cs9.html","id":"task-configuration","dir":"Articles","previous_headings":"Example","what":"Task configuration","title":"Introduction to CS9","text":"“register” task, use ss$add_task: number important things code need highlighting.","code":"# tm_run_task(\"example_weather_import_data_from_api\") ss$add_task(   name_grouping = \"example_weather\",   name_action = \"import_data_from_api\",   name_variant = NULL,   cores = 1,   plan_analysis_fn_name = NULL, # \"PACKAGE::TASK_NAME_plan_analysis\"   for_each_plan = plnr::expand_list(     location_code = \"county03\" # fhidata::norway_locations_names()[granularity_geo %in% c(\"county\")]$location_code   ),   for_each_analysis = NULL,   universal_argset = NULL,   upsert_at_end_of_each_plan = FALSE,   insert_at_end_of_each_plan = FALSE,   action_fn_name = \"example_weather_import_data_from_api_action\",   data_selector_fn_name = \"example_weather_import_data_from_api_data_selector\",   tables = list(     # input      # output     \"anon_example_weather\" = ss$tables$anon_example_weather   ) )"},{"path":"https://www.csids.no/cs9/articles/cs9.html","id":"for_each_plan","dir":"Articles","previous_headings":"Example > Task configuration","what":"for_each_plan","title":"Introduction to CS9","text":"for_each_plan expects list. component list correspond plan, values added argset analyses inside plan. example, following code give 4 plans, 1 analysis per plan, analysis containing argset$var_1 argset$var_2 appropriate. always need least 1 plan. simple plan possible :","code":"for_each_plan <- list() for_each_plan[[1]] <- list(   var_1 = 1,   var_2 = \"a\" ) for_each_plan[[2]] <- list(   var_1 = 2,   var_2 = \"b\" ) for_each_plan[[3]] <- list(   var_1 = 1,   var_2 = \"a\" ) for_each_plan[[4]] <- list(   var_1 = 2,   var_2 = \"b\" ) plnr::expand_list(   x = 1 ) #> [[1]] #> [[1]]$x #> [1] 1"},{"path":"https://www.csids.no/cs9/articles/cs9.html","id":"plnrexpand_list","dir":"Articles","previous_headings":"Example > Task configuration","what":"plnr::expand_list","title":"Introduction to CS9","text":"plnr::expand_list esentially expand.grid, except return values lists instead data.frame. code simplified follows.","code":"for_each_plan <- plnr::expand_list(   var_1 = c(1,2),   var_2 = c(\"a\", \"b\") ) for_each_plan #> [[1]] #> [[1]]$var_1 #> [1] 1 #>  #> [[1]]$var_2 #> [1] \"a\" #>  #>  #> [[2]] #> [[2]]$var_1 #> [1] 2 #>  #> [[2]]$var_2 #> [1] \"a\" #>  #>  #> [[3]] #> [[3]]$var_1 #> [1] 1 #>  #> [[3]]$var_2 #> [1] \"b\" #>  #>  #> [[4]] #> [[4]]$var_1 #> [1] 2 #>  #> [[4]]$var_2 #> [1] \"b\""},{"path":"https://www.csids.no/cs9/articles/cs9.html","id":"for_each_analysis","dir":"Articles","previous_headings":"Example > Task configuration","what":"for_each_analysis","title":"Introduction to CS9","text":"for_each_plan expects list, generate length(for_each_plan) plans. for_each_analysis , except generate analyses within plans.","code":""},{"path":"https://www.csids.no/cs9/articles/cs9.html","id":"universal_argset","dir":"Articles","previous_headings":"Example > Task configuration","what":"universal_argset","title":"Introduction to CS9","text":"named list add values argset analyses.","code":""},{"path":"https://www.csids.no/cs9/articles/cs9.html","id":"upsert_at_end_of_each_plan","dir":"Articles","previous_headings":"Example > Task configuration","what":"upsert_at_end_of_each_plan","title":"Introduction to CS9","text":"TRUE tables contains table called output, returned values action_fn stored upserted tables$output end plan. TRUE returned values action_fn named lists, values within named lists stored upserted tables$NAME_FROM_LIST end plan. choose upsert/insert manually within action_fn, can end analysis.","code":""},{"path":"https://www.csids.no/cs9/articles/cs9.html","id":"insert_at_end_of_each_plan","dir":"Articles","previous_headings":"Example > Task configuration","what":"insert_at_end_of_each_plan","title":"Introduction to CS9","text":"TRUE tables contains table called output, returned values action_fn stored inserted tables$output end plan. TRUE returned values action_fn named lists, values within named lists stored inserted tables$NAME_FROM_LIST end plan. choose upsert/insert manually within action_fn, can end analysis.","code":""},{"path":"https://www.csids.no/cs9/articles/cs9.html","id":"action_fn_name","dir":"Articles","previous_headings":"Example > Task configuration","what":"action_fn_name","title":"Introduction to CS9","text":"character string action_fn, preferably including package name.","code":""},{"path":"https://www.csids.no/cs9/articles/cs9.html","id":"data_selector_fn_name","dir":"Articles","previous_headings":"Example > Task configuration","what":"data_selector_fn_name","title":"Introduction to CS9","text":"character string data_selector_fn, preferably including package name.","code":""},{"path":"https://www.csids.no/cs9/articles/cs9.html","id":"schema","dir":"Articles","previous_headings":"Example > Task configuration","what":"schema","title":"Introduction to CS9","text":"named list containing schemas used task.","code":""},{"path":"https://www.csids.no/cs9/articles/cs9.html","id":"data_selector_fn","dir":"Articles","previous_headings":"Example","what":"data_selector_fn","title":"Introduction to CS9","text":"data_selector_fn used extract data plan. lines inside (plnr::is_run_directly()){ used help developers. can run code manually/interactively “load” values argset schema.","code":"index_plan <- 1  argset <- ss$shortcut_get_argset(\"example_weather_import_data_from_api\", index_plan = index_plan) tables <- ss$shortcut_get_tables(\"example_weather_import_data_from_api\")  print(argset) #> $`**universal**` #> [1] \"*\" #>  #> $`**plan**` #> [1] \"*\" #>  #> $location_code #> [1] \"county03\" #>  #> $`**analysis**` #> [1] \"*\" #>  #> $`**automatic**` #> [1] \"*\" #>  #> $index #> [1] 1 #>  #> $today #> [1] \"2025-08-21\" #>  #> $yesterday #> [1] \"2025-08-20\" #>  #> $index_plan #> [1] 1 #>  #> $index_analysis #> [1] 1 #>  #> $first_analysis #> [1] TRUE #>  #> $last_analysis #> [1] TRUE #>  #> $within_plan_first_analysis #> [1] TRUE #>  #> $within_plan_last_analysis #> [1] TRUE print(tables) #> $anon_example_weather #> public.anon_example_weather (disconnected) #>  #>   1: granularity_time (TEXT) (KEY) #>   2: granularity_geo (TEXT)  #>   3: country_iso3 (TEXT)  #>   4: location_code (TEXT) (KEY) #>   5: border (INTEGER)  #>   6: age (TEXT) (KEY) #>   7: sex (TEXT) (KEY) #>   8: isoyear (INTEGER)  #>   9: isoweek (INTEGER)  #>  10: isoyearweek (TEXT)  #>  11: season (TEXT)  #>  12: seasonweek (DOUBLE)  #>  13: calyear (INTEGER)  #>  14: calmonth (INTEGER)  #>  15: calyearmonth (TEXT)  #>  16: date (DATE) (KEY) #>  17: tg (DOUBLE)  #>  18: tx (DOUBLE)  #>  19: tn (DOUBLE)  #>  20: auto_last_updated_datetime (DATETIME) # **** data_selector **** ---- #' example_weather_import_data_from_api (data selector) #' @param argset Argset #' @param tables DB tables #' @export example_weather_import_data_from_api_data_selector = function(argset, tables){   if(plnr::is_run_directly()){     # global$ss$shortcut_get_plans_argsets_as_dt(\"example_weather_import_data_from_api\")      index_plan <- 1      argset <- ss$shortcut_get_argset(\"example_weather_import_data_from_api\", index_plan = index_plan)     tables <- ss$shortcut_get_tables(\"example_weather_import_data_from_api\")   }    # find the mid lat/long for the specified location_code   gps <- fhimaps::norway_nuts3_map_b2020_default_dt[location_code == argset$location_code,.(     lat = mean(lat),     long = mean(long)   )]    # download the forecast for the specified location_code   d <- httr::GET(glue::glue(\"https://api.met.no/weatherapi/locationforecast/2.0/classic?lat={gps$lat}&lon={gps$long}\"), httr::content_type_xml())   d <- xml2::read_xml(d$content)    # The variable returned must be a named list   retval <- list(     \"data\" = d   )   retval }"},{"path":"https://www.csids.no/cs9/articles/cs9.html","id":"action_fn","dir":"Articles","previous_headings":"Example","what":"action_fn","title":"Introduction to CS9","text":"lines inside (plnr::is_run_directly()){ used help developers. can run code manually/interactively “load” values argset schema.","code":"index_plan <- 1 index_analysis <- 1  data <- ss$shortcut_get_data(\"example_weather_import_data_from_api\", index_plan = index_plan) argset <- ss$shortcut_get_argset(\"example_weather_import_data_from_api\", index_plan = index_plan, index_analysis = index_analysis) tables <- ss$shortcut_get_tables(\"example_weather_import_data_from_api\")  print(data) #> $data #> {xml_document} #> <weatherdata noNamespaceSchemaLocation=\"https://schema.api.met.no/schemas/weatherapi-0.4.xsd\" created=\"2025-08-21T13:28:23Z\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"> #> [1] <meta>\\n  <model name=\"met_public_forecast\" termin=\"2025-08-21T13:00:00Z\" ... #> [2] <product class=\"pointData\">\\n  <time datatype=\"forecast\" from=\"2025-08-21 ... #>  #> $hash #> $hash$current #> [1] \"fa7c1fd90a6d9bf24040ae24919e6972\" #>  #> $hash$current_elements #> $hash$current_elements$data #> [1] \"edf868d91cd1f5fe47b57b2aeb1d010d\" print(argset) #> $`**universal**` #> [1] \"*\" #>  #> $`**plan**` #> [1] \"*\" #>  #> $location_code #> [1] \"county03\" #>  #> $`**analysis**` #> [1] \"*\" #>  #> $`**automatic**` #> [1] \"*\" #>  #> $index #> [1] 1 #>  #> $today #> [1] \"2025-08-21\" #>  #> $yesterday #> [1] \"2025-08-20\" #>  #> $index_plan #> [1] 1 #>  #> $index_analysis #> [1] 1 #>  #> $first_analysis #> [1] TRUE #>  #> $last_analysis #> [1] TRUE #>  #> $within_plan_first_analysis #> [1] TRUE #>  #> $within_plan_last_analysis #> [1] TRUE print(tables) #> $anon_example_weather #> public.anon_example_weather (disconnected) #>  #>   1: granularity_time (TEXT) (KEY) #>   2: granularity_geo (TEXT)  #>   3: country_iso3 (TEXT)  #>   4: location_code (TEXT) (KEY) #>   5: border (INTEGER)  #>   6: age (TEXT) (KEY) #>   7: sex (TEXT) (KEY) #>   8: isoyear (INTEGER)  #>   9: isoweek (INTEGER)  #>  10: isoyearweek (TEXT)  #>  11: season (TEXT)  #>  12: seasonweek (DOUBLE)  #>  13: calyear (INTEGER)  #>  14: calmonth (INTEGER)  #>  15: calyearmonth (TEXT)  #>  16: date (DATE) (KEY) #>  17: tg (DOUBLE)  #>  18: tx (DOUBLE)  #>  19: tn (DOUBLE)  #>  20: auto_last_updated_datetime (DATETIME) # **** action **** ---- #' example_weather_import_data_from_api (action) #' @param data Data #' @param argset Argset #' @param tables DB tables #' @export example_weather_import_data_from_api_action <- function(data, argset, tables) {   # tm_run_task(\"example_weather_import_data_from_api\")    if(plnr::is_run_directly()){     # global$ss$shortcut_get_plans_argsets_as_dt(\"example_weather_import_data_from_api\")      index_plan <- 1     index_analysis <- 1      data <- ss$shortcut_get_data(\"example_weather_import_data_from_api\", index_plan = index_plan)     argset <- ss$shortcut_get_argset(\"example_weather_import_data_from_api\", index_plan = index_plan, index_analysis = index_analysis)     tables <- ss$shortcut_get_tables(\"example_weather_import_data_from_api\")   }    # code goes here   # special case that runs before everything   if(argset$first_analysis == TRUE){    }    a <- data$data    baz <- xml2::xml_find_all(a, \".//maxTemperature\")   res <- vector(\"list\", length = length(baz))   for (i in seq_along(baz)) {     parent <- xml2::xml_parent(baz[[i]])     grandparent <- xml2::xml_parent(parent)     time_from <- xml2::xml_attr(grandparent, \"from\")     time_to <- xml2::xml_attr(grandparent, \"to\")     x <- xml2::xml_find_all(parent, \".//minTemperature\")     temp_min <- xml2::xml_attr(x, \"value\")     x <- xml2::xml_find_all(parent, \".//maxTemperature\")     temp_max <- xml2::xml_attr(x, \"value\")     res[[i]] <- data.frame(       time_from = as.character(time_from),       time_to = as.character(time_to),       tx = as.numeric(temp_max),       tn = as.numeric(temp_min)     )   }   res <- rbindlist(res)   res <- res[stringr::str_sub(time_from, 12, 13) %in% c(\"00\", \"06\", \"12\", \"18\")]   res[, date := as.Date(stringr::str_sub(time_from, 1, 10))]   res[, N := .N, by = date]   res <- res[N == 4]   res <- res[     ,     .(       tg = NA,       tx = max(tx),       tn = min(tn)     ),     keyby = .(date)   ]    # we look at the downloaded data   print(\"Data after downloading\")   print(res)    # we now need to format it   res[, granularity_time := \"day\"]   res[, sex := \"total\"]   res[, age := \"total\"]   res[, location_code := argset$location_code]   res[, border := 2020]    # fill in missing structural variables   cstidy::set_csfmt_rts_data_v1(res)    # we look at the downloaded data   print(\"Data after missing structural variables filled in\")   print(res)    # put data in db table   # tables$TABLE_NAME$insert_data(d)   tables$anon_example_weather$upsert_data(res)   # tables$TABLE_NAME$drop_all_rows_and_then_upsert_data(d)    # special case that runs after everything   # copy to anon_web?   if(argset$last_analysis == TRUE){     # cs9::copy_into_new_table_where(     #   table_from = \"anon_X\",     #   table_to = \"anon_web_X\"     # )   } }"},{"path":"https://www.csids.no/cs9/articles/cs9.html","id":"run-the-task","dir":"Articles","previous_headings":"Example","what":"Run the task","title":"Introduction to CS9","text":"","code":"ss$run_task(\"example_weather_import_data_from_api\") #> task: example_weather_import_data_from_api #> Running task=example_weather_import_data_from_api with plans=1 and analyses=1 #> plans=sequential, argset=sequential with cores=1 #>  #> [1] \"Data after downloading\" #> Key: <date> #>          date     tg    tx    tn #>        <Date> <lgcl> <num> <num> #> 1: 2025-08-22     NA  16.0   8.8 #> 2: 2025-08-23     NA  17.6   8.0 #> 3: 2025-08-24     NA  18.4   9.8 #> 4: 2025-08-25     NA  18.1   8.8 #> 5: 2025-08-26     NA  18.8   8.9 #> 6: 2025-08-27     NA  19.7   9.2 #> 7: 2025-08-28     NA  20.4  10.2 #> 8: 2025-08-29     NA  19.0  10.1 #> 9: 2025-08-30     NA  16.9  12.1 #> [1] \"Data after missing structural variables filled in\" #>    granularity_time granularity_geo country_iso3 location_code border    age #>              <char>          <char>       <char>        <char>  <int> <char> #> 1:              day          county          nor      county03   2020  total #> 2:              day          county          nor      county03   2020  total #> 3:              day          county          nor      county03   2020  total #> 4:              day          county          nor      county03   2020  total #> 5:              day          county          nor      county03   2020  total #> 6:              day          county          nor      county03   2020  total #> 7:              day          county          nor      county03   2020  total #> 8:              day          county          nor      county03   2020  total #> 9:              day          county          nor      county03   2020  total #>       sex isoyear isoweek isoyearweek season seasonweek calyear calmonth #>    <char>   <int>   <int>      <char> <char>      <num>   <int>    <int> #> 1:  total      NA      NA        <NA>   <NA>         NA      NA       NA #> 2:  total      NA      NA        <NA>   <NA>         NA      NA       NA #> 3:  total      NA      NA        <NA>   <NA>         NA      NA       NA #> 4:  total      NA      NA        <NA>   <NA>         NA      NA       NA #> 5:  total      NA      NA        <NA>   <NA>         NA      NA       NA #> 6:  total      NA      NA        <NA>   <NA>         NA      NA       NA #> 7:  total      NA      NA        <NA>   <NA>         NA      NA       NA #> 8:  total      NA      NA        <NA>   <NA>         NA      NA       NA #> 9:  total      NA      NA        <NA>   <NA>         NA      NA       NA #>    calyearmonth       date     tg    tx    tn #>          <char>     <Date> <lgcl> <num> <num> #> 1:         <NA> 2025-08-22     NA  16.0   8.8 #> 2:         <NA> 2025-08-23     NA  17.6   8.0 #> 3:         <NA> 2025-08-24     NA  18.4   9.8 #> 4:         <NA> 2025-08-25     NA  18.1   8.8 #> 5:         <NA> 2025-08-26     NA  18.8   8.9 #> 6:         <NA> 2025-08-27     NA  19.7   9.2 #> 7:         <NA> 2025-08-28     NA  20.4  10.2 #> 8:         <NA> 2025-08-29     NA  19.0  10.1 #> 9:         <NA> 2025-08-30     NA  16.9  12.1 #> Error in super$upsert_data(newdata, drop_indexes, verbose): upsert_load_data_infile not validated in anon_example_weather. granularity_time"},{"path":[]},{"path":"https://www.csids.no/cs9/articles/cs9.html","id":"importing-data","dir":"Articles","previous_headings":"Different types of tasks","what":"Importing data","title":"Introduction to CS9","text":"","code":"ss$add_task(   name_grouping = \"example\",   name_action = \"import_data\",   name_variant = NULL,   cores = 1,   plan_analysis_fn_name = NULL,   for_each_plan = plnr::expand_list(     x = 1   ),   for_each_analysis = NULL,   universal_argset = list(     folder = cs9::path(\"input\", \"example\")   ),   upsert_at_end_of_each_plan = FALSE,   insert_at_end_of_each_plan = FALSE,   action_fn_name = \"example_import_data_action\",   data_selector_fn_name = \"example_import_data_data_selector\",   tables = list(     # input      # output     \"output\" = ss$tables$output   ) )"},{"path":"https://www.csids.no/cs9/articles/cs9.html","id":"analysis","dir":"Articles","previous_headings":"Different types of tasks","what":"Analysis","title":"Introduction to CS9","text":"","code":"ss$add_task(   name_grouping = \"example\",   name_action = \"analysis\",   name_variant = NULL,   cores = 1,   plan_analysis_fn_name = NULL,   for_each_plan = plnr::expand_list(     location_code = csdata::nor_locations_names()[granularity_geo %in% c(\"county\")]$location_code   ),   for_each_analysis = NULL,   universal_argset = NULL,   upsert_at_end_of_each_plan = FALSE,   insert_at_end_of_each_plan = FALSE,   action_fn_name = \"example_analysis_action\",   data_selector_fn_name = \"example_analysis_data_selector\",   tables = list(     # input     \"input\" = ss$tables$input,      # output     \"output\" = ss$tables   ) )"},{"path":"https://www.csids.no/cs9/articles/cs9.html","id":"exporting-multiple-sets-of-results","dir":"Articles","previous_headings":"Different types of tasks","what":"Exporting multiple sets of results","title":"Introduction to CS9","text":"","code":"ss$add_task(   name_grouping = \"example\",   name_action = \"export_results\",   name_variant = NULL,   cores = 1,   plan_analysis_fn_name = NULL,   for_each_plan = plnr::expand_list(     location_code = csdata::nor_locations_names()[granularity_geo %in% c(\"county\")]$location_code   ),   for_each_analysis = NULL,   universal_argset = list(     folder = cs9::path(\"output\", \"example\")   ),   upsert_at_end_of_each_plan = FALSE,   insert_at_end_of_each_plan = FALSE,   action_fn_name = \"example_export_results_action\",   data_selector_fn_name = \"example_export_results_data_selector\",   tables = list(     # input     \"input\" = ss$tables$input      # output   ) )"},{"path":"https://www.csids.no/cs9/articles/cs9.html","id":"exporting-combined-results","dir":"Articles","previous_headings":"Different types of tasks","what":"Exporting combined results","title":"Introduction to CS9","text":"","code":"ss$tables(   name_grouping = \"example\",   name_action = \"export_results\",   name_variant = NULL,   cores = 1,   plan_analysis_fn_name = NULL,   for_each_plan = plnr::expand_list(     x = 1   ),   for_each_analysis = NULL,   universal_argset = list(     folder = cs9::path(\"output\", \"example\"),     granularity_geos = c(\"nation\", \"county\")   ),   upsert_at_end_of_each_plan = FALSE,   insert_at_end_of_each_plan = FALSE,   action_fn_name = \"example_export_results_action\",   data_selector_fn_name = \"example_export_results_data_selector\",   tables = list(     # input     \"input\" = ss$tables$input      # output   ) )"},{"path":"https://www.csids.no/cs9/articles/cs9.html","id":"deployment-patterns","dir":"Articles","previous_headings":"","what":"Deployment patterns","title":"Introduction to CS9","text":"CS9 systems typically follow deployment pattern: Development: Use devtools::load_all() interactive development Testing: Run individual tasks global$ss$run_task(\"task_name\") Production: Deploy Docker containers Airflow scheduling Monitoring: Use built-logging configuration tracking","code":""},{"path":"https://www.csids.no/cs9/articles/cs9.html","id":"getting-started","dir":"Articles","previous_headings":"","what":"Getting started","title":"Introduction to CS9","text":"implement surveillance system: Clone cs9example repository Perform global find/replace “cs9example” package name Modify table definitions 03_tables.R data Update task definitions 04_tasks.R analyses Implement surveillance tasks following established patterns approach ensures start working, tested framework rather building scratch.","code":""},{"path":"https://www.csids.no/cs9/articles/cs9.html","id":"next-steps","dir":"Articles","previous_headings":"","what":"Next steps","title":"Introduction to CS9","text":"Evaluate CS9: Install CRAN explore documentation Review cs9example: Study complete example implementation Set infrastructure: Configure database environment Clone cs9example: Use template surveillance system Customize: Modify example specific surveillance needs detailed infrastructure setup, see Installation vignette. learning create tasks, see Creating Task vignette. understanding file organization, see File Layout vignette.","code":""},{"path":"https://www.csids.no/cs9/articles/file-layout.html","id":"package-template","dir":"Articles","previous_headings":"","what":"Package Template","title":"File Layout","text":"fastest way start cloning complete example: sections show required files contents initialization order.","code":"git clone https://github.com/csids/cs9example.git cd cs9example # Global find/replace \"cs9example\" with your package name"},{"path":"https://www.csids.no/cs9/articles/file-layout.html","id":"env_and_namespace-r","dir":"Articles","previous_headings":"","what":"00_env_and_namespace.R","title":"File Layout","text":"https://github.com/csids/cs9example/blob/main/R/00_env_and_namespace.R","code":"# Environment and namespace configuration # This file sets up the package environment and namespace exports  # Set environment variable for package data location Sys.setenv(CS9EXAMPLE_PACKAGE_DIR = system.file(\"\", package = \"cs9example\"))  # Export functions to namespace #' @export get_package_dir <- function() {   return(Sys.getenv(\"CS9EXAMPLE_PACKAGE_DIR\")) }  #' @export   set_config <- function() {   # Initialize configuration settings   config <- list()   return(config) }"},{"path":"https://www.csids.no/cs9/articles/file-layout.html","id":"definitions-r","dir":"Articles","previous_headings":"","what":"01_definitions.R","title":"File Layout","text":"https://github.com/csids/cs9example/blob/main/R/01_definitions.R","code":"# Project-specific definitions # This file contains global definitions used throughout the surveillance system  #' Set project definitions #' @export set_definitions <- function() {   # Define global variables   global <- new.env(parent = emptyenv())      # Configuration settings   global$config <- list()   global$config$border <- 2020   global$config$granularity_time <- c(\"day\", \"week\")   global$config$granularity_geo <- c(\"nation\", \"county\", \"municip\")      # Set in global environment   assign(\"global\", global, envir = .GlobalEnv)      return(invisible()) }"},{"path":"https://www.csids.no/cs9/articles/file-layout.html","id":"surveillance_systems-r","dir":"Articles","previous_headings":"","what":"02_surveillance_systems.R","title":"File Layout","text":"https://github.com/csids/cs9example/blob/main/R/02_surveillance_systems.R","code":"# Initialize surveillance systems # This file creates the main surveillance system objects  #' Set surveillance systems #' @export set_surveillance_systems <- function() {   # Create surveillance system   global$ss <- cs9::SurveillanceSystem_v9$new(     name = \"cs9example\",     implementation_version = \"1.0.0\"   )      return(invisible()) }"},{"path":"https://www.csids.no/cs9/articles/file-layout.html","id":"tables-r","dir":"Articles","previous_headings":"","what":"03_tables.R","title":"File Layout","text":"https://github.com/csids/cs9example/blob/main/R/03_tables.R","code":"# Database table definitions # This file defines all database tables used by the surveillance system  #' Set database tables #' @export set_db_tables <- function() {   # Weather data table   global$ss$add_table(     name_access = \"anon\",     name_grouping = \"weather\",     name_variant = \"data_raw\",     field_types = c(       \"granularity_time\" = \"TEXT\",       \"granularity_geo\" = \"TEXT\",       \"country_iso3\" = \"TEXT\",       \"location_code\" = \"TEXT\",       \"border\" = \"INTEGER\",       \"age\" = \"TEXT\",       \"sex\" = \"TEXT\",       \"date\" = \"DATE\",       \"temp_max\" = \"DOUBLE\",       \"temp_min\" = \"DOUBLE\"     ),     keys = c(\"granularity_time\", \"location_code\", \"date\", \"age\", \"sex\")   )      return(invisible()) }"},{"path":"https://www.csids.no/cs9/articles/file-layout.html","id":"tasks-r","dir":"Articles","previous_headings":"","what":"04_tasks.R","title":"File Layout","text":"https://github.com/csids/cs9example/blob/main/R/04_tasks.R","code":"# Task definitions # This file defines all surveillance tasks  #' Set surveillance tasks #' @export set_tasks <- function() {   # Weather data download task   global$ss$add_task(     name_grouping = \"weather\",     name_action = \"download_and_import\",     name_variant = \"rawdata\",     cores = 1,     for_each_plan = list(       location_code = c(\"norge\", \"sweden\"),       today = lubridate::today()     ),     for_each_analysis = NULL,     universal_argset = list(       folder = cs9::path(\"input\", \"weather\")     ),     upsert_at_end_of_each_plan = FALSE,     insert_at_end_of_each_plan = TRUE,     action_fn_name = \"weather_download_and_import_rawdata_action\",     data_selector_fn_name = \"weather_download_and_import_rawdata_data_selector\",     tables = list(       \"anon_weather_data_raw\" = \"anon_weather_data_raw\"     )   )      return(invisible()) }"},{"path":"https://www.csids.no/cs9/articles/file-layout.html","id":"deliverables-r","dir":"Articles","previous_headings":"","what":"05_deliverables.R","title":"File Layout","text":"https://github.com/csids/cs9example/blob/main/R/05_deliverables.R","code":"# Deliverable definitions (optional) # This file defines outputs and reports generated by the surveillance system  #' Set deliverables #' @export set_deliverables <- function() {   # Example deliverable configuration   # Can be used to define automated reports, plots, or exports      message(\"Deliverables configuration loaded\")   return(invisible()) }"},{"path":"https://www.csids.no/cs9/articles/file-layout.html","id":"onload-r","dir":"Articles","previous_headings":"","what":"10_onLoad.R","title":"File Layout","text":"https://github.com/csids/cs9example/blob/main/R/10_onLoad.R","code":"# Package loading sequence # This file defines what happens when the package is loaded  .onLoad <- function(libname, pkgname) {   # Set up progress bar handling   progressr::handlers(progressr::handler_progress(     format = \"[:bar] :current/:total (:percent) in :elapsedfull, eta: :eta\",     clear = FALSE   ))      # Initialize package components in correct order   set_definitions()   set_surveillance_systems()    set_db_tables()   set_tasks()      # Optional: set_deliverables()      invisible() }"},{"path":"https://www.csids.no/cs9/articles/file-layout.html","id":"onattach-r","dir":"Articles","previous_headings":"","what":"11_onAttach.R","title":"File Layout","text":"https://github.com/csids/cs9example/blob/main/R/11_onAttach.R","code":"# Package attachment messages # This file defines startup messages when package is attached  .onAttach <- function(libname, pkgname) {   packageStartupMessage(\"cs9example surveillance system loaded\")   packageStartupMessage(\"Use global$ss to access the surveillance system\")   packageStartupMessage(\"Available tasks: \", paste(names(global$ss$tasks), collapse = \", \"))      invisible() }"},{"path":"https://www.csids.no/cs9/articles/file-layout.html","id":"task-files","dir":"Articles","previous_headings":"","what":"Task files","title":"File Layout","text":"Task files placed .R files names.","code":""},{"path":"https://www.csids.no/cs9/articles/file-layout.html","id":"weather_download_and_import_rawdata-r","dir":"Articles","previous_headings":"Task files","what":"weather_download_and_import_rawdata.R","title":"File Layout","text":"https://github.com/csids/cs9example/blob/main/R/weather_download_and_import_rawdata.R","code":"# Weather data download and import task # This file implements the weather data collection task  #' Weather data selector #' @param argset Named list of arguments #' @param tables Named list of database tables #' @return List containing data for processing #' @export weather_download_and_import_rawdata_data_selector <- function(argset, tables) {   # In real implementation, this would download from external API   # For demonstration, return empty list   return(list()) }  #' Weather data action #' @param data Data from data selector function #' @param argset Named list of arguments #' @param tables Named list of database tables   #' @return NULL (side effect: inserts data into database) #' @export weather_download_and_import_rawdata_action <- function(data, argset, tables) {   # Download weather data for specified location and date   weather_data <- data.table::data.table(     granularity_time = \"day\",     granularity_geo = \"nation\",      country_iso3 = \"NOR\",     location_code = argset$location_code,     border = global$config$border,     age = \"total\",     sex = \"total\",     date = argset$today,     temp_max = runif(1, 15, 25),     temp_min = runif(1, 5, 15)   )      # Insert into database   tables$anon_weather_data_raw$insert_data(weather_data)      return(invisible()) }"},{"path":"https://www.csids.no/cs9/articles/file-layout.html","id":"weather_clean_data-r","dir":"Articles","previous_headings":"Task files","what":"weather_clean_data.R","title":"File Layout","text":"https://github.com/csids/cs9example/blob/main/R/weather_clean_data.R","code":"# Weather data cleaning task # This file implements data cleaning and validation  #' Weather cleaning data selector #' @param argset Named list of arguments #' @param tables Named list of database tables #' @return List containing raw weather data #' @export weather_clean_data_data_selector <- function(argset, tables) {   # Get raw weather data from database   raw_data <- tables$anon_weather_data_raw$tbl() %>%     dplyr::filter(       date >= argset$date_from,       date <= argset$date_to     ) %>%     dplyr::collect() %>%     data.table::as.data.table()      return(list(     raw_data = raw_data   )) }  #' Weather cleaning action #' @param data Data from data selector function #' @param argset Named list of arguments #' @param tables Named list of database tables #' @return NULL (side effect: processes and validates data) #' @export weather_clean_data_action <- function(data, argset, tables) {   # Apply data cleaning rules   clean_data <- data$raw_data      # Remove outliers   clean_data <- clean_data[     temp_max >= -50 & temp_max <= 60 &     temp_min >= -60 & temp_min <= 50   ]      # Add data quality indicators   clean_data[, data_quality := \"good\"]      # Log cleaning results   cs9::update_config_log(     task = \"weather_clean_data\",     msg = paste(\"Cleaned\", nrow(clean_data), \"weather records\")   )      return(invisible()) }"},{"path":"https://www.csids.no/cs9/articles/file-layout.html","id":"weather_export_weather_plots-r","dir":"Articles","previous_headings":"Task files","what":"weather_export_weather_plots.R","title":"File Layout","text":"https://github.com/csids/cs9example/blob/main/R/weather_export_plots.R","code":"# Weather plotting and export task   # This file implements visualization and reporting  #' Weather plotting data selector #' @param argset Named list of arguments #' @param tables Named list of database tables #' @return List containing weather data for plotting #' @export weather_export_plots_data_selector <- function(argset, tables) {   # Get processed weather data   plot_data <- tables$anon_weather_data_raw$tbl() %>%     dplyr::filter(       location_code == argset$location_code,       date >= argset$date_from,       date <= argset$date_to     ) %>%     dplyr::collect() %>%     data.table::as.data.table()      return(list(     weather_data = plot_data   )) }  #' Weather plotting action #' @param data Data from data selector function #' @param argset Named list of arguments #' @param tables Named list of database tables #' @return NULL (side effect: creates and saves plots) #' @export weather_export_plots_action <- function(data, argset, tables) {   # Create temperature plot   if(nrow(data$weather_data) > 0) {     # Generate filename     filename <- paste0(       \"weather_\", argset$location_code, \"_\",        format(Sys.Date(), \"%Y%m%d\"), \".png\"     )          # Create simple plot     plot_data <- data$weather_data          p <- ggplot2::ggplot(plot_data, ggplot2::aes(x = date)) +       ggplot2::geom_line(ggplot2::aes(y = temp_max, color = \"Max\")) +       ggplot2::geom_line(ggplot2::aes(y = temp_min, color = \"Min\")) +       ggplot2::labs(         title = paste(\"Temperature for\", argset$location_code),         x = \"Date\", y = \"Temperature (°C)\"       ) +       ggplot2::theme_minimal()          # Save plot     ggplot2::ggsave(       filename = file.path(argset$output_dir, filename),       plot = p, width = 10, height = 6, dpi = 150     )          # Log completion     cs9::update_config_log(       task = \"weather_export_plots\",       msg = paste(\"Created plot:\", filename)     )   }      return(invisible()) }"},{"path":"https://www.csids.no/cs9/articles/file-layout.html","id":"implementation-notes","dir":"Articles","previous_headings":"","what":"Implementation Notes","title":"File Layout","text":"Initialization Order: Files numbered indicate required loading sequence .onLoad() Global Environment: global object provides shared access surveillance system configuration Task Organization: surveillance task gets file data selector action functions Schema Management: Database table definitions centralized 03_tables.R","code":""},{"path":"https://www.csids.no/cs9/articles/file-layout.html","id":"next-steps","dir":"Articles","previous_headings":"","what":"Next Steps","title":"File Layout","text":"organizing files using structure: Configure Environment: Follow vignette(\"installation\") set database environment variables Understand Concepts: Read vignette(\"cs9\") architecture terminology Implement Tasks: Use vignette(\"creating--task\") build surveillance workflows Deploy: Set production infrastructure using Docker Airflow file organization provides solid foundation scalable surveillance systems proper separation concerns clear initialization patterns.","code":""},{"path":"https://www.csids.no/cs9/articles/installation.html","id":"installation-options","dir":"Articles","previous_headings":"","what":"Installation options","title":"Installation","text":"CS9 can installed two configurations:","code":""},{"path":"https://www.csids.no/cs9/articles/installation.html","id":"cran-installation-limited-functionality","dir":"Articles","previous_headings":"Installation options","what":"1. CRAN installation (limited functionality)","title":"Installation","text":"Install CS9 directly CRAN documentation, examples, development tools: works CRAN installation: Package documentation help files Function examples vignettes Environment diagnostic tools (cs9::check_environment_setup()) Code templates development utilities Basic configuration management Limitations: database connectivity run surveillance tasks Limited documentation development aids","code":"install.packages(\"cs9\") library(cs9)"},{"path":"https://www.csids.no/cs9/articles/installation.html","id":"full-installation-database-driven-surveillance","dir":"Articles","previous_headings":"Installation options","what":"2. Full installation (database-driven surveillance)","title":"Installation","text":"complete surveillance functionality, need database infrastructure proper configuration. strongly recommend using CS9 within Docker environment production deployments.","code":""},{"path":"https://www.csids.no/cs9/articles/installation.html","id":"database-setup","dir":"Articles","previous_headings":"","what":"Database Setup","title":"Installation","text":"CS9 requires PostgreSQL database backend full functionality.","code":""},{"path":[]},{"path":"https://www.csids.no/cs9/articles/installation.html","id":"option-1-docker-postgresql-recommended","dir":"Articles","previous_headings":"Database Setup > PostgreSQL Installation","what":"Option 1: Docker PostgreSQL (Recommended)","title":"Installation","text":"","code":"# Run PostgreSQL in Docker docker run --name cs9-postgres -e POSTGRES_PASSWORD=yourStrongPassword100 \\   -e POSTGRES_DB=cs9_surveillance -p 5432:5432 -d postgres:13  # Connect to create additional databases/schemas as needed docker exec -it cs9-postgres psql -U postgres -d cs9_surveillance"},{"path":"https://www.csids.no/cs9/articles/installation.html","id":"option-2-system-installation","dir":"Articles","previous_headings":"Database Setup > PostgreSQL Installation","what":"Option 2: System Installation","title":"Installation","text":"","code":"# Ubuntu/Debian sudo apt-get install postgresql postgresql-contrib  # macOS with Homebrew brew install postgresql  # Start PostgreSQL service sudo systemctl start postgresql  # Linux brew services start postgresql   # macOS"},{"path":"https://www.csids.no/cs9/articles/installation.html","id":"database-schema-setup","dir":"Articles","previous_headings":"Database Setup","what":"Database Schema Setup","title":"Installation","text":"PostgreSQL running, create surveillance database:","code":"-- Connect as postgres user CREATE DATABASE cs9_surveillance; CREATE USER cs9_user WITH PASSWORD 'yourStrongPassword100'; GRANT ALL PRIVILEGES ON DATABASE cs9_surveillance TO cs9_user;  -- Create schemas for different access levels \\c cs9_surveillance CREATE SCHEMA config; CREATE SCHEMA anon; GRANT ALL ON SCHEMA config TO cs9_user; GRANT ALL ON SCHEMA anon TO cs9_user;"},{"path":"https://www.csids.no/cs9/articles/installation.html","id":"environment-variable-configuration","dir":"Articles","previous_headings":"","what":"Environment Variable Configuration","title":"Installation","text":"CS9 requires specific environment variables connect database. variables must available R, typically .Renviron file.","code":""},{"path":"https://www.csids.no/cs9/articles/installation.html","id":"setting-up--renviron","dir":"Articles","previous_headings":"Environment Variable Configuration","what":"Setting up .Renviron","title":"Installation","text":"Find create .Renviron file: Add CS9 configuration variables: Restart R session making changes .Renviron","code":"# Check current .Renviron location Sys.getenv(\"R_ENVIRON_USER\")  # Open .Renviron file for editing file.edit(\"~/.Renviron\") # CS9 Core Configuration CS9_AUTO=0 CS9_PATH=  # Database Connection Settings CS9_DBCONFIG_ACCESS=config/anon CS9_DBCONFIG_DRIVER=PostgreSQL Unicode CS9_DBCONFIG_PORT=5432 CS9_DBCONFIG_SERVER=localhost CS9_DBCONFIG_USER=cs9_user CS9_DBCONFIG_PASSWORD=yourStrongPassword100 CS9_DBCONFIG_SSLMODE=prefer  # Database Schema Configuration CS9_DBCONFIG_SCHEMA_CONFIG=config CS9_DBCONFIG_DB_CONFIG=cs9_surveillance CS9_DBCONFIG_SCHEMA_ANON=anon CS9_DBCONFIG_DB_ANON=cs9_surveillance"},{"path":[]},{"path":"https://www.csids.no/cs9/articles/installation.html","id":"package-behavior-without-database-configuration","dir":"Articles","previous_headings":"","what":"Package behavior without database configuration","title":"Installation","text":"install CS9 CRAN without setting database configuration, package load limited functionality. see messages like: can use cs9::check_environment_setup() diagnose needs configured full functionality.","code":"Environment setup failed: Missing required environment variables: CS9_DBCONFIG_ACCESS, CS9_DBCONFIG_DRIVER, CS9_DBCONFIG_PORT, CS9_DBCONFIG_SERVER CS9 database configuration not available. Package loaded with limited functionality. Use cs9::check_environment_setup() to diagnose configuration issues."},{"path":"https://www.csids.no/cs9/articles/installation.html","id":"docker","dir":"Articles","previous_headings":"","what":"Docker","title":"Installation","text":"CS9 designed work within containerized environment production use. example docker-compose file available . getting started, recommend cloning cs9example repository, provides complete template implementing surveillance system CS9.","code":""},{"path":"https://www.csids.no/cs9/articles/installation.html","id":"transitioning-from-cran-to-full-setup","dir":"Articles","previous_headings":"","what":"Transitioning from CRAN to full setup","title":"Installation","text":"installed CS9 CRAN want enable full surveillance functionality: Check Current Status Set Database Install PostgreSQL MariaDB Create databases surveillance system Note connection parameters (host, port, username, password) Configure Environment Variables Add variables listed .Renviron file Restart R session Run cs9::check_environment_setup() verify configuration Test Full Functionality","code":"cs9::check_environment_setup() # This should now work without errors ss <- cs9::SurveillanceSystem_v9$new(name = \"test_system\")"},{"path":[]},{"path":"https://www.csids.no/cs9/articles/installation.html","id":"verify-your-setup","dir":"Articles","previous_headings":"Verification and Troubleshooting","what":"Verify Your Setup","title":"Installation","text":"completing installation steps, verify CS9 working correctly:","code":"# Load CS9 library(cs9)  # Check environment configuration cs9::check_environment_setup()  # Test surveillance system creation ss <- cs9::SurveillanceSystem_v9$new(name = \"test_surveillance\") print(ss$name)  # Should print \"test_surveillance\""},{"path":[]},{"path":"https://www.csids.no/cs9/articles/installation.html","id":"issue-missing-required-environment-variables","dir":"Articles","previous_headings":"Verification and Troubleshooting > Common Issues and Solutions","what":"Issue: “Missing required environment variables”","title":"Installation","text":"Solution: Ensure CS9_DBCONFIG_* variables set .Renviron file restart R.","code":""},{"path":"https://www.csids.no/cs9/articles/installation.html","id":"issue-could-not-connect-to-database","dir":"Articles","previous_headings":"Verification and Troubleshooting > Common Issues and Solutions","what":"Issue: “Could not connect to database”","title":"Installation","text":"Solutions: - Verify PostgreSQL running: sudo systemctl status postgresql (Linux) brew services list | grep postgres (macOS) - Check database credentials match .Renviron configuration - Test connection manually: docker exec -cs9-postgres psql -U cs9_user -d cs9_surveillance","code":""},{"path":"https://www.csids.no/cs9/articles/installation.html","id":"issue-package-loaded-with-limited-functionality","dir":"Articles","previous_headings":"Verification and Troubleshooting > Common Issues and Solutions","what":"Issue: “Package loaded with limited functionality”","title":"Installation","text":"Solution: normal CRAN installation without database setup. Follow database configuration steps .","code":""},{"path":"https://www.csids.no/cs9/articles/installation.html","id":"issue-permission-denied-errors","dir":"Articles","previous_headings":"Verification and Troubleshooting > Common Issues and Solutions","what":"Issue: Permission denied errors","title":"Installation","text":"Solution: Verify database user proper permissions:","code":"GRANT ALL PRIVILEGES ON DATABASE cs9_surveillance TO cs9_user; GRANT ALL ON SCHEMA config TO cs9_user; GRANT ALL ON SCHEMA anon TO cs9_user;"},{"path":"https://www.csids.no/cs9/articles/installation.html","id":"next-steps","dir":"Articles","previous_headings":"","what":"Next Steps","title":"Installation","text":"CS9 successfully installed configured: Learn Framework: Read vignette(\"cs9\") architecture concepts Create First Task: Follow vignette(\"creating--task\") hands-tutorial Organize Project: See vignette(\"file-layout\") package structure guidance Explore Examples: Clone cs9example complete implementation template","code":""},{"path":"https://www.csids.no/cs9/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"package proudly brought : Richard Aubrey White. Author, maintainer. . Copyright holder. See changelog contributors. 🙏","code":""},{"path":"https://www.csids.no/cs9/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"White RA (2025). cs9: Framework Real-Time Analysis Disease Surveillance. R package version 2025.8.21, https://www.csids./cs9/.","code":"@Manual{,   title = {cs9: A Framework for Real-Time Analysis and Disease Surveillance},   author = {Richard Aubrey White},   year = {2025},   note = {R package version 2025.8.21},   url = {https://www.csids.no/cs9/}, }"},{"path":[]},{"path":"https://www.csids.no/cs9/index.html","id":"overview","dir":"","previous_headings":"","what":"Overview","title":"A Framework for Real-Time Analysis and Disease Surveillance","text":"Core Surveillance 9 (“cs9”) free open-source framework real-time analysis disease surveillance. Read introduction vignette run help(package=\"cs9\").","code":""},{"path":"https://www.csids.no/cs9/index.html","id":"csverse","dir":"","previous_headings":"","what":"csverse","title":"A Framework for Real-Time Analysis and Disease Surveillance","text":"csverse set R packages developed help solve problems frequently occur performing disease surveillance. packages can installed directly CRAN.","code":"install.packages(\"attrib\") install.packages(\"cs9\") install.packages(\"csalert\") install.packages(\"csdata\") install.packages(\"csdb\") install.packages(\"csmaps\") install.packages(\"csstyle\") install.packages(\"cstidy\") install.packages(\"cstime\") install.packages(\"csutil\") install.packages(\"org\") install.packages(\"plnr\")"},{"path":"https://www.csids.no/cs9/reference/SurveillanceSystem_v9.html","id":null,"dir":"Reference","previous_headings":"","what":"A Surveillance System Object — SurveillanceSystem_v9","title":"A Surveillance System Object — SurveillanceSystem_v9","text":"Core R6 class creating managing disease surveillance systems. class orchestrates database tables, tasks, analyses real-time epidemiological monitoring public health surveillance.","code":""},{"path":"https://www.csids.no/cs9/reference/SurveillanceSystem_v9.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"A Surveillance System Object — SurveillanceSystem_v9","text":"SurveillanceSystem_v9 provides infrastructure : Database table management automated logging Task scheduling parallel execution Data validation schema enforcement Configuration performance monitoring surveillance system follows structured approach: Define database tables add_table() Configure surveillance tasks add_task() Execute tasks run_task() external schedulers","code":""},{"path":"https://www.csids.no/cs9/reference/SurveillanceSystem_v9.html","id":"public-fields","dir":"Reference","previous_headings":"","what":"Public fields","title":"A Surveillance System Object — SurveillanceSystem_v9","text":"tables List database tables managed surveillance system partitionedtables List partitioned database tables tasks List surveillance tasks configured execution name Character string identifying surveillance system instance implementation_version Character string tracking analytics code version","code":""},{"path":[]},{"path":"https://www.csids.no/cs9/reference/SurveillanceSystem_v9.html","id":"public-methods","dir":"Reference","previous_headings":"","what":"Public methods","title":"A Surveillance System Object — SurveillanceSystem_v9","text":"SurveillanceSystem_v9$new() SurveillanceSystem_v9$add_table() SurveillanceSystem_v9$add_partitionedtable() SurveillanceSystem_v9$add_task() SurveillanceSystem_v9$get_task() SurveillanceSystem_v9$run_task() SurveillanceSystem_v9$shortcut_get_tables() SurveillanceSystem_v9$shortcut_get_argset() SurveillanceSystem_v9$shortcut_get_data() SurveillanceSystem_v9$shortcut_get_plans_argsets_as_dt() SurveillanceSystem_v9$shortcut_get_num_analyses() SurveillanceSystem_v9$clone()","code":""},{"path":[]},{"path":"https://www.csids.no/cs9/reference/SurveillanceSystem_v9.html","id":"usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A Surveillance System Object — SurveillanceSystem_v9","text":"","code":"SurveillanceSystem_v9$new(   name = \"unspecified\",   implementation_version = \"unspecified\" )"},{"path":"https://www.csids.no/cs9/reference/SurveillanceSystem_v9.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"A Surveillance System Object — SurveillanceSystem_v9","text":"name string user may choose use track performance metrics (runtime RAM usage) implementation_version string user may choose use track performance metrics (runtime RAM usage)","code":""},{"path":"https://www.csids.no/cs9/reference/SurveillanceSystem_v9.html","id":"method-add-table-","dir":"Reference","previous_headings":"","what":"Method add_table()","title":"A Surveillance System Object — SurveillanceSystem_v9","text":"Add table","code":""},{"path":"https://www.csids.no/cs9/reference/SurveillanceSystem_v9.html","id":"usage-1","dir":"Reference","previous_headings":"","what":"Usage","title":"A Surveillance System Object — SurveillanceSystem_v9","text":"","code":"SurveillanceSystem_v9$add_table(   name_access,   name_grouping = NULL,   name_variant = NULL,   field_types,   keys,   indexes = NULL,   validator_field_types = csdb::validator_field_types_blank,   validator_field_contents = csdb::validator_field_contents_blank )"},{"path":"https://www.csids.no/cs9/reference/SurveillanceSystem_v9.html","id":"arguments-1","dir":"Reference","previous_headings":"","what":"Arguments","title":"A Surveillance System Object — SurveillanceSystem_v9","text":"name_access First part table name, corresponding database stored. name_grouping Second part table name, corresponding sort grouping. name_variant Final part table name, corresponding distinguishing variant. field_types Named character vector, names column names, values column types. Valid types BOOLEAN, CHARACTER, INTEGER, DOUBLE, DATE, DATETIME keys Character vector, containing column names uniquely identify row data. indexes Named list, containing indexes. validator_field_types Function corresponding validator field types. validator_field_contents Function corresponding validator field contents.","code":""},{"path":"https://www.csids.no/cs9/reference/SurveillanceSystem_v9.html","id":"returns","dir":"Reference","previous_headings":"","what":"Returns","title":"A Surveillance System Object — SurveillanceSystem_v9","text":"return value. method called side effect adding table surveillance system.","code":""},{"path":"https://www.csids.no/cs9/reference/SurveillanceSystem_v9.html","id":"examples","dir":"Reference","previous_headings":"","what":"Examples","title":"A Surveillance System Object — SurveillanceSystem_v9","text":"","code":"\\dontrun{ global$ss$add_table(   name_access = c(\"anon\"),   name_grouping = \"example_weather\",   name_variant = \"data\",   field_types =  c(     \"granularity_time\" = \"TEXT\",     \"granularity_geo\" = \"TEXT\",     \"country_iso3\" = \"TEXT\",     \"location_code\" = \"TEXT\",     \"border\" = \"INTEGER\",     \"age\" = \"TEXT\",     \"sex\" = \"TEXT\",      \"isoyear\" = \"INTEGER\",     \"isoweek\" = \"INTEGER\",     \"isoyearweek\" = \"TEXT\",     \"season\" = \"TEXT\",     \"seasonweek\" = \"DOUBLE\",      \"calyear\" = \"INTEGER\",     \"calmonth\" = \"INTEGER\",     \"calyearmonth\" = \"TEXT\",      \"date\" = \"DATE\",      \"temp_max\" = \"DOUBLE\",     \"temp_min\" = \"DOUBLE\",     \"precip\" = \"DOUBLE\"   ),   keys = c(     \"granularity_time\",     \"location_code\",     \"date\",     \"age\",     \"sex\"   ),   validator_field_types = csdb::validator_field_types_csfmt_rts_data_v1,   validator_field_contents = csdb::validator_field_contents_csfmt_rts_data_v1 ) }"},{"path":"https://www.csids.no/cs9/reference/SurveillanceSystem_v9.html","id":"method-add-partitionedtable-","dir":"Reference","previous_headings":"","what":"Method add_partitionedtable()","title":"A Surveillance System Object — SurveillanceSystem_v9","text":"Add partitioned table surveillance system","code":""},{"path":"https://www.csids.no/cs9/reference/SurveillanceSystem_v9.html","id":"usage-2","dir":"Reference","previous_headings":"","what":"Usage","title":"A Surveillance System Object — SurveillanceSystem_v9","text":"","code":"SurveillanceSystem_v9$add_partitionedtable(   name_access,   name_grouping = NULL,   name_variant = NULL,   name_partitions = \"default\",   column_name_partition = \"partition\",   value_generator_partition = NULL,   field_types,   keys,   indexes = NULL,   validator_field_types = csdb::validator_field_types_blank,   validator_field_contents = csdb::validator_field_contents_blank )"},{"path":"https://www.csids.no/cs9/reference/SurveillanceSystem_v9.html","id":"arguments-2","dir":"Reference","previous_headings":"","what":"Arguments","title":"A Surveillance System Object — SurveillanceSystem_v9","text":"name_access First part table name, corresponding database stored name_grouping Second part table name, corresponding sort grouping name_variant Final part table name, corresponding distinguishing variant name_partitions Character string specifying partition naming scheme column_name_partition Column name used partitioning value_generator_partition Function generate partition values field_types Named character vector column names types keys Character vector column names uniquely identify rows indexes Named list containing index definitions validator_field_types Function validate field types validator_field_contents Function validate field contents","code":""},{"path":"https://www.csids.no/cs9/reference/SurveillanceSystem_v9.html","id":"returns-1","dir":"Reference","previous_headings":"","what":"Returns","title":"A Surveillance System Object — SurveillanceSystem_v9","text":"return value. method called side effect adding partitioned table surveillance system.","code":""},{"path":"https://www.csids.no/cs9/reference/SurveillanceSystem_v9.html","id":"method-add-task-","dir":"Reference","previous_headings":"","what":"Method add_task()","title":"A Surveillance System Object — SurveillanceSystem_v9","text":"Add surveillance task system","code":""},{"path":"https://www.csids.no/cs9/reference/SurveillanceSystem_v9.html","id":"usage-3","dir":"Reference","previous_headings":"","what":"Usage","title":"A Surveillance System Object — SurveillanceSystem_v9","text":"","code":"SurveillanceSystem_v9$add_task(   name_grouping = NULL,   name_action = NULL,   name_variant = NULL,   cores = 1,   permission = NULL,   plan_analysis_fn_name = NULL,   for_each_plan = NULL,   for_each_analysis = NULL,   universal_argset = NULL,   upsert_at_end_of_each_plan = FALSE,   insert_at_end_of_each_plan = FALSE,   action_fn_name,   data_selector_fn_name = NULL,   tables = NULL )"},{"path":"https://www.csids.no/cs9/reference/SurveillanceSystem_v9.html","id":"arguments-3","dir":"Reference","previous_headings":"","what":"Arguments","title":"A Surveillance System Object — SurveillanceSystem_v9","text":"name_grouping Name task (grouping) name_action Name task (action) name_variant Name task (variant) cores Number CPU cores permission permission R6 instance plan_analysis_fn_name name function returns named list list(for_each_plan = list(), for_each_analysis = NULL). for_each_plan list, unit corresponds one data extraction. Generally recommended use plnr::expand_list. for_each_analysis list, unit corresponds one analysis within plan (data extraction). Generally recommended use plnr::expand_list. universal_argset list, argsets applied analyses univerally upsert_at_end_of_each_plan want upsert results automatically end plan? insert_at_end_of_each_plan want insert results automatically end plan? action_fn_name name function called analysis arguments data, argset, schema data_selector_fn_name name function called obtain data analysis. function must arguments argset, schema must return named list. tables named list maps cs9::config$schemas use action_fn_name data_selector_fn_name","code":""},{"path":"https://www.csids.no/cs9/reference/SurveillanceSystem_v9.html","id":"returns-2","dir":"Reference","previous_headings":"","what":"Returns","title":"A Surveillance System Object — SurveillanceSystem_v9","text":"return value. method called side effect adding task surveillance system.","code":""},{"path":"https://www.csids.no/cs9/reference/SurveillanceSystem_v9.html","id":"method-get-task-","dir":"Reference","previous_headings":"","what":"Method get_task()","title":"A Surveillance System Object — SurveillanceSystem_v9","text":"Get surveillance task name","code":""},{"path":"https://www.csids.no/cs9/reference/SurveillanceSystem_v9.html","id":"usage-4","dir":"Reference","previous_headings":"","what":"Usage","title":"A Surveillance System Object — SurveillanceSystem_v9","text":"","code":"SurveillanceSystem_v9$get_task(task_name)"},{"path":"https://www.csids.no/cs9/reference/SurveillanceSystem_v9.html","id":"arguments-4","dir":"Reference","previous_headings":"","what":"Arguments","title":"A Surveillance System Object — SurveillanceSystem_v9","text":"task_name Character string specifying task name","code":""},{"path":"https://www.csids.no/cs9/reference/SurveillanceSystem_v9.html","id":"returns-3","dir":"Reference","previous_headings":"","what":"Returns","title":"A Surveillance System Object — SurveillanceSystem_v9","text":"Task R6 object representing surveillance task","code":""},{"path":"https://www.csids.no/cs9/reference/SurveillanceSystem_v9.html","id":"method-run-task-","dir":"Reference","previous_headings":"","what":"Method run_task()","title":"A Surveillance System Object — SurveillanceSystem_v9","text":"Execute surveillance task name","code":""},{"path":"https://www.csids.no/cs9/reference/SurveillanceSystem_v9.html","id":"usage-5","dir":"Reference","previous_headings":"","what":"Usage","title":"A Surveillance System Object — SurveillanceSystem_v9","text":"","code":"SurveillanceSystem_v9$run_task(task_name)"},{"path":"https://www.csids.no/cs9/reference/SurveillanceSystem_v9.html","id":"arguments-5","dir":"Reference","previous_headings":"","what":"Arguments","title":"A Surveillance System Object — SurveillanceSystem_v9","text":"task_name Character string specifying task name run","code":""},{"path":"https://www.csids.no/cs9/reference/SurveillanceSystem_v9.html","id":"returns-4","dir":"Reference","previous_headings":"","what":"Returns","title":"A Surveillance System Object — SurveillanceSystem_v9","text":"return value. method called side effect executing task.","code":""},{"path":"https://www.csids.no/cs9/reference/SurveillanceSystem_v9.html","id":"method-shortcut-get-tables-","dir":"Reference","previous_headings":"","what":"Method shortcut_get_tables()","title":"A Surveillance System Object — SurveillanceSystem_v9","text":"Get database tables associated task","code":""},{"path":"https://www.csids.no/cs9/reference/SurveillanceSystem_v9.html","id":"usage-6","dir":"Reference","previous_headings":"","what":"Usage","title":"A Surveillance System Object — SurveillanceSystem_v9","text":"","code":"SurveillanceSystem_v9$shortcut_get_tables(task_name)"},{"path":"https://www.csids.no/cs9/reference/SurveillanceSystem_v9.html","id":"arguments-6","dir":"Reference","previous_headings":"","what":"Arguments","title":"A Surveillance System Object — SurveillanceSystem_v9","text":"task_name Character string specifying task name","code":""},{"path":"https://www.csids.no/cs9/reference/SurveillanceSystem_v9.html","id":"returns-5","dir":"Reference","previous_headings":"","what":"Returns","title":"A Surveillance System Object — SurveillanceSystem_v9","text":"named list database table objects used task","code":""},{"path":"https://www.csids.no/cs9/reference/SurveillanceSystem_v9.html","id":"method-shortcut-get-argset-","dir":"Reference","previous_headings":"","what":"Method shortcut_get_argset()","title":"A Surveillance System Object — SurveillanceSystem_v9","text":"Get argument set specific plan analysis","code":""},{"path":"https://www.csids.no/cs9/reference/SurveillanceSystem_v9.html","id":"usage-7","dir":"Reference","previous_headings":"","what":"Usage","title":"A Surveillance System Object — SurveillanceSystem_v9","text":"","code":"SurveillanceSystem_v9$shortcut_get_argset(   task_name,   index_plan = 1,   index_analysis = 1 )"},{"path":"https://www.csids.no/cs9/reference/SurveillanceSystem_v9.html","id":"arguments-7","dir":"Reference","previous_headings":"","what":"Arguments","title":"A Surveillance System Object — SurveillanceSystem_v9","text":"task_name Character string specifying task name index_plan Integer specifying plan access index_analysis Integer specifying analysis access","code":""},{"path":"https://www.csids.no/cs9/reference/SurveillanceSystem_v9.html","id":"returns-6","dir":"Reference","previous_headings":"","what":"Returns","title":"A Surveillance System Object — SurveillanceSystem_v9","text":"named list containing argument set specified plan analysis","code":""},{"path":"https://www.csids.no/cs9/reference/SurveillanceSystem_v9.html","id":"method-shortcut-get-data-","dir":"Reference","previous_headings":"","what":"Method shortcut_get_data()","title":"A Surveillance System Object — SurveillanceSystem_v9","text":"Get data specific plan","code":""},{"path":"https://www.csids.no/cs9/reference/SurveillanceSystem_v9.html","id":"usage-8","dir":"Reference","previous_headings":"","what":"Usage","title":"A Surveillance System Object — SurveillanceSystem_v9","text":"","code":"SurveillanceSystem_v9$shortcut_get_data(task_name, index_plan = 1)"},{"path":"https://www.csids.no/cs9/reference/SurveillanceSystem_v9.html","id":"arguments-8","dir":"Reference","previous_headings":"","what":"Arguments","title":"A Surveillance System Object — SurveillanceSystem_v9","text":"task_name Character string specifying task name index_plan Integer specifying plan access","code":""},{"path":"https://www.csids.no/cs9/reference/SurveillanceSystem_v9.html","id":"returns-7","dir":"Reference","previous_headings":"","what":"Returns","title":"A Surveillance System Object — SurveillanceSystem_v9","text":"named list containing data extracted specified plan","code":""},{"path":"https://www.csids.no/cs9/reference/SurveillanceSystem_v9.html","id":"method-shortcut-get-plans-argsets-as-dt-","dir":"Reference","previous_headings":"","what":"Method shortcut_get_plans_argsets_as_dt()","title":"A Surveillance System Object — SurveillanceSystem_v9","text":"Get plans argsets data.table","code":""},{"path":"https://www.csids.no/cs9/reference/SurveillanceSystem_v9.html","id":"usage-9","dir":"Reference","previous_headings":"","what":"Usage","title":"A Surveillance System Object — SurveillanceSystem_v9","text":"","code":"SurveillanceSystem_v9$shortcut_get_plans_argsets_as_dt(task_name)"},{"path":"https://www.csids.no/cs9/reference/SurveillanceSystem_v9.html","id":"arguments-9","dir":"Reference","previous_headings":"","what":"Arguments","title":"A Surveillance System Object — SurveillanceSystem_v9","text":"task_name Character string specifying task name","code":""},{"path":"https://www.csids.no/cs9/reference/SurveillanceSystem_v9.html","id":"returns-8","dir":"Reference","previous_headings":"","what":"Returns","title":"A Surveillance System Object — SurveillanceSystem_v9","text":"data.table containing plan analysis information columns including index_plan index_analysis","code":""},{"path":"https://www.csids.no/cs9/reference/SurveillanceSystem_v9.html","id":"method-shortcut-get-num-analyses-","dir":"Reference","previous_headings":"","what":"Method shortcut_get_num_analyses()","title":"A Surveillance System Object — SurveillanceSystem_v9","text":"Get total number analyses task","code":""},{"path":"https://www.csids.no/cs9/reference/SurveillanceSystem_v9.html","id":"usage-10","dir":"Reference","previous_headings":"","what":"Usage","title":"A Surveillance System Object — SurveillanceSystem_v9","text":"","code":"SurveillanceSystem_v9$shortcut_get_num_analyses(task_name)"},{"path":"https://www.csids.no/cs9/reference/SurveillanceSystem_v9.html","id":"arguments-10","dir":"Reference","previous_headings":"","what":"Arguments","title":"A Surveillance System Object — SurveillanceSystem_v9","text":"task_name Character string specifying task name","code":""},{"path":"https://www.csids.no/cs9/reference/SurveillanceSystem_v9.html","id":"returns-9","dir":"Reference","previous_headings":"","what":"Returns","title":"A Surveillance System Object — SurveillanceSystem_v9","text":"Integer value representing total number analyses across plans task","code":""},{"path":"https://www.csids.no/cs9/reference/SurveillanceSystem_v9.html","id":"method-clone-","dir":"Reference","previous_headings":"","what":"Method clone()","title":"A Surveillance System Object — SurveillanceSystem_v9","text":"objects class cloneable method.","code":""},{"path":"https://www.csids.no/cs9/reference/SurveillanceSystem_v9.html","id":"usage-11","dir":"Reference","previous_headings":"","what":"Usage","title":"A Surveillance System Object — SurveillanceSystem_v9","text":"","code":"SurveillanceSystem_v9$clone(deep = FALSE)"},{"path":"https://www.csids.no/cs9/reference/SurveillanceSystem_v9.html","id":"arguments-11","dir":"Reference","previous_headings":"","what":"Arguments","title":"A Surveillance System Object — SurveillanceSystem_v9","text":"deep Whether make deep clone.","code":""},{"path":"https://www.csids.no/cs9/reference/SurveillanceSystem_v9.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"A Surveillance System Object — SurveillanceSystem_v9","text":"","code":"if (FALSE) { # \\dontrun{ # Create surveillance system ss <- SurveillanceSystem_v9$new(   name = \"covid_surveillance\",   implementation_version = \"1.0\" )  # Add database table ss$add_table(   name_access = \"anon\",   name_grouping = \"covid\",   name_variant = \"cases\",   field_types = c(\"date\" = \"DATE\", \"cases\" = \"INTEGER\"),   keys = c(\"date\") )  # Add surveillance task ss$add_task(   name_grouping = \"covid\",   name_action = \"import\",   name_variant = \"daily_data\",   action_fn_name = \"import_covid_data\",   data_selector_fn_name = \"select_covid_sources\" )  # Run task ss$run_task(\"covid_import_daily_data\") } # }   ## ------------------------------------------------ ## Method `SurveillanceSystem_v9$add_table` ## ------------------------------------------------  if (FALSE) { # \\dontrun{ global$ss$add_table(   name_access = c(\"anon\"),   name_grouping = \"example_weather\",   name_variant = \"data\",   field_types =  c(     \"granularity_time\" = \"TEXT\",     \"granularity_geo\" = \"TEXT\",     \"country_iso3\" = \"TEXT\",     \"location_code\" = \"TEXT\",     \"border\" = \"INTEGER\",     \"age\" = \"TEXT\",     \"sex\" = \"TEXT\",      \"isoyear\" = \"INTEGER\",     \"isoweek\" = \"INTEGER\",     \"isoyearweek\" = \"TEXT\",     \"season\" = \"TEXT\",     \"seasonweek\" = \"DOUBLE\",      \"calyear\" = \"INTEGER\",     \"calmonth\" = \"INTEGER\",     \"calyearmonth\" = \"TEXT\",      \"date\" = \"DATE\",      \"temp_max\" = \"DOUBLE\",     \"temp_min\" = \"DOUBLE\",     \"precip\" = \"DOUBLE\"   ),   keys = c(     \"granularity_time\",     \"location_code\",     \"date\",     \"age\",     \"sex\"   ),   validator_field_types = csdb::validator_field_types_csfmt_rts_data_v1,   validator_field_contents = csdb::validator_field_contents_csfmt_rts_data_v1 ) } # }"},{"path":"https://www.csids.no/cs9/reference/check_environment_setup.html","id":null,"dir":"Reference","previous_headings":"","what":"Check Environment Setup — check_environment_setup","title":"Check Environment Setup — check_environment_setup","text":"Diagnostic function check CS9 environment configuration. function validates required environment variables database connectivity, providing detailed feedback troubleshooting configuration issues.","code":""},{"path":"https://www.csids.no/cs9/reference/check_environment_setup.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check Environment Setup — check_environment_setup","text":"","code":"check_environment_setup(verbose = TRUE, use_startup_message = FALSE)"},{"path":"https://www.csids.no/cs9/reference/check_environment_setup.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check Environment Setup — check_environment_setup","text":"verbose Logical. TRUE (default), prints detailed diagnostic output. FALSE, runs validation silently returns result object. use_startup_message Logical. TRUE, uses packageStartupMessage() output (suppressible). FALSE (default), uses cat() console output.","code":""},{"path":"https://www.csids.no/cs9/reference/check_environment_setup.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check Environment Setup — check_environment_setup","text":"list containing environment setup status recommendations: status: \"ok\", \"warning\", \"error\" issues: Character vector identified problems recommendations: Character vector suggested fixes","code":""},{"path":"https://www.csids.no/cs9/reference/check_environment_setup.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Check Environment Setup — check_environment_setup","text":"CS9 requires specific environment variables database connectivity configuration. function checks : Required environment variables (CS9_DBCONFIG_ACCESS, CS9_DBCONFIG_DRIVER, etc.) Database configuration availability Database table initialization status CS9 installed CRAN without database configuration, package loads limited functionality. Use function diagnose needs configured full database-driven surveillance functionality.","code":""},{"path":[]},{"path":"https://www.csids.no/cs9/reference/check_environment_setup.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Check Environment Setup — check_environment_setup","text":"","code":"# Check environment setup with verbose output check_environment_setup() #> CS9 Environment Check Results: #> Status:  error  #>  #> Issues found: #>  -  Missing required environment variables: CS9_AUTO, CS9_PATH, CS9_DBCONFIG_ACCESS, CS9_DBCONFIG_DRIVER, CS9_DBCONFIG_PORT, CS9_DBCONFIG_SERVER  #>  -  No database configurations available  #>  -  No configuration tables initialized  #>  #> Recommendations: #>  -  Set required environment variables before loading CS9  #>  -  Refer to CS9 documentation for environment setup instructions  #>  -  Verify CS9_DBCONFIG_ACCESS is properly set  #>  -  Check database connectivity and permissions  #>   # Check silently and examine results result <- check_environment_setup(verbose = FALSE) if(result$status != \"ok\") {   cat(\"Issues found:\", result$issues, \"\\n\")   cat(\"Recommendations:\", result$recommendations, \"\\n\") } #> Issues found: Missing required environment variables: CS9_AUTO, CS9_PATH, CS9_DBCONFIG_ACCESS, CS9_DBCONFIG_DRIVER, CS9_DBCONFIG_PORT, CS9_DBCONFIG_SERVER No database configurations available No configuration tables initialized  #> Recommendations: Set required environment variables before loading CS9 Refer to CS9 documentation for environment setup instructions Verify CS9_DBCONFIG_ACCESS is properly set Check database connectivity and permissions"},{"path":"https://www.csids.no/cs9/reference/config.html","id":null,"dir":"Reference","previous_headings":"","what":"Flags/values to be used in the 'dashboards' scene — config","title":"Flags/values to be used in the 'dashboards' scene — config","text":"Flags/values used 'dashboards' scene","code":""},{"path":"https://www.csids.no/cs9/reference/config.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Flags/values to be used in the 'dashboards' scene — config","text":"","code":"config"},{"path":"https://www.csids.no/cs9/reference/config.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Flags/values to be used in the 'dashboards' scene — config","text":"object class environment length 7.","code":""},{"path":"https://www.csids.no/cs9/reference/create_folder_if_doesnt_exist.html","id":null,"dir":"Reference","previous_headings":"","what":"Create Folder If It Doesn't Exist — create_folder_if_doesnt_exist","title":"Create Folder If It Doesn't Exist — create_folder_if_doesnt_exist","text":"Creates directory necessary parent directories already exist.","code":""},{"path":"https://www.csids.no/cs9/reference/create_folder_if_doesnt_exist.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create Folder If It Doesn't Exist — create_folder_if_doesnt_exist","text":"","code":"create_folder_if_doesnt_exist(path)"},{"path":"https://www.csids.no/cs9/reference/create_folder_if_doesnt_exist.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create Folder If It Doesn't Exist — create_folder_if_doesnt_exist","text":"path Character string specifying directory path create","code":""},{"path":"https://www.csids.no/cs9/reference/create_folder_if_doesnt_exist.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create Folder If It Doesn't Exist — create_folder_if_doesnt_exist","text":"Character string containing created directory path","code":""},{"path":"https://www.csids.no/cs9/reference/create_folder_if_doesnt_exist.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create Folder If It Doesn't Exist — create_folder_if_doesnt_exist","text":"","code":"if (FALSE) { # \\dontrun{ # Create a new directory create_folder_if_doesnt_exist(\"/tmp/my_analysis/results\") } # }"},{"path":"https://www.csids.no/cs9/reference/create_latest_folder.html","id":null,"dir":"Reference","previous_headings":"","what":"Create Latest Folder — create_latest_folder","title":"Create Latest Folder — create_latest_folder","text":"Copies results dated folder \"latest\" folder, providing easy access recent analysis results.","code":""},{"path":"https://www.csids.no/cs9/reference/create_latest_folder.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create Latest Folder — create_latest_folder","text":"","code":"create_latest_folder(results_folder_name, date)"},{"path":"https://www.csids.no/cs9/reference/create_latest_folder.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create Latest Folder — create_latest_folder","text":"results_folder_name Character string specifying name results folder (subdirectory \"output\") date Character string specifying date extraction (used identify source folder)","code":""},{"path":"https://www.csids.no/cs9/reference/create_latest_folder.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create Latest Folder — create_latest_folder","text":"return value. function called side effect copying files dated folder latest folder.","code":""},{"path":"https://www.csids.no/cs9/reference/create_latest_folder.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Create Latest Folder — create_latest_folder","text":"function copies contents output/results_folder_name/date output/results_folder_name/latest, overwriting existing files.","code":""},{"path":"https://www.csids.no/cs9/reference/create_latest_folder.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create Latest Folder — create_latest_folder","text":"","code":"if (FALSE) { # \\dontrun{ # Copy today's results to latest folder create_latest_folder(\"covid_reports\", \"2024-01-15\") } # }"},{"path":"https://www.csids.no/cs9/reference/get_config_data_hash_for_each_plan.html","id":null,"dir":"Reference","previous_headings":"","what":"Get Configuration Data Hash for Each Plan — get_config_data_hash_for_each_plan","title":"Get Configuration Data Hash for Each Plan — get_config_data_hash_for_each_plan","text":"Retrieves data hash configuration entries database table tracking data changes across surveillance task plans elements.","code":""},{"path":"https://www.csids.no/cs9/reference/get_config_data_hash_for_each_plan.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get Configuration Data Hash for Each Plan — get_config_data_hash_for_each_plan","text":"","code":"get_config_data_hash_for_each_plan(   task = NULL,   index_plan = NULL,   element_tag = NULL )"},{"path":"https://www.csids.no/cs9/reference/get_config_data_hash_for_each_plan.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get Configuration Data Hash for Each Plan — get_config_data_hash_for_each_plan","text":"task Character string specifying task name filter . NULL, returns data tasks. index_plan Integer specifying plan index filter . NULL, returns data plans. element_tag Character string specifying element tag filter . NULL, returns data elements.","code":""},{"path":"https://www.csids.no/cs9/reference/get_config_data_hash_for_each_plan.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get Configuration Data Hash for Each Plan — get_config_data_hash_for_each_plan","text":"data.table containing filtered hash configuration entries columns: task, index_plan, element_tag, date, datetime, element_hash, all_hash","code":""},{"path":"https://www.csids.no/cs9/reference/get_config_data_hash_for_each_plan.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get Configuration Data Hash for Each Plan — get_config_data_hash_for_each_plan","text":"","code":"if (FALSE) { # \\dontrun{ # Get all hash data for a specific task get_config_data_hash_for_each_plan(task = \"covid_analysis\")  # Get hash data for specific task and plan get_config_data_hash_for_each_plan(task = \"covid_analysis\", index_plan = 1) } # }"},{"path":"https://www.csids.no/cs9/reference/get_config_log.html","id":null,"dir":"Reference","previous_headings":"","what":"Get Configuration Log — get_config_log","title":"Get Configuration Log — get_config_log","text":"Retrieves configuration log entries config_log table optional filtering surveillance system identifier, task name, date range.","code":""},{"path":"https://www.csids.no/cs9/reference/get_config_log.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get Configuration Log — get_config_log","text":"","code":"get_config_log(ss = NULL, task = NULL, start_date = NULL, end_date = NULL)"},{"path":"https://www.csids.no/cs9/reference/get_config_log.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get Configuration Log — get_config_log","text":"ss Character. Surveillance system identifier filter . Defaults NULL (filtering). task Character. Task name filter . Defaults NULL (filtering). start_date Character. Start date (YYYY-MM-DD) filtering log entries. Defaults NULL. end_date Character. End date (YYYY-MM-DD) filtering log entries. Defaults NULL.","code":""},{"path":"https://www.csids.no/cs9/reference/get_config_log.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get Configuration Log — get_config_log","text":"data.table containing filtered log entries.","code":""},{"path":"https://www.csids.no/cs9/reference/get_config_log.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Get Configuration Log — get_config_log","text":"function retrieves entries config_log table current configuration. date filters provided, applied timestamp field log entries.","code":""},{"path":"https://www.csids.no/cs9/reference/get_config_log.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get Configuration Log — get_config_log","text":"","code":"if (FALSE) { # \\dontrun{ # Get all log entries get_config_log()  # Get logs for a specific surveillance system get_config_log(ss = \"weather\")  # Get logs for a specific task and date range get_config_log(task = \"data_import\", start_date = \"2024-01-01\", end_date = \"2024-12-31\") } # }"},{"path":"https://www.csids.no/cs9/reference/get_config_tables_last_updated.html","id":null,"dir":"Reference","previous_headings":"","what":"Get Configuration Tables Last Updated — get_config_tables_last_updated","title":"Get Configuration Tables Last Updated — get_config_tables_last_updated","text":"Retrieves last updated timestamps database tables configuration tracking system.","code":""},{"path":"https://www.csids.no/cs9/reference/get_config_tables_last_updated.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get Configuration Tables Last Updated — get_config_tables_last_updated","text":"","code":"get_config_tables_last_updated(table_name = NULL)"},{"path":"https://www.csids.no/cs9/reference/get_config_tables_last_updated.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get Configuration Tables Last Updated — get_config_tables_last_updated","text":"table_name Character string specifying table name filter . NULL, returns data tables.","code":""},{"path":"https://www.csids.no/cs9/reference/get_config_tables_last_updated.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get Configuration Tables Last Updated — get_config_tables_last_updated","text":"data.table containing last updated information columns: table_name, last_updated_datetime, tracking metadata","code":""},{"path":"https://www.csids.no/cs9/reference/get_config_tables_last_updated.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get Configuration Tables Last Updated — get_config_tables_last_updated","text":"","code":"if (FALSE) { # \\dontrun{ # Get last updated info for all tables get_config_tables_last_updated()  # Get info for a specific table get_config_tables_last_updated(table_name = \"anon_covid_cases\") } # }"},{"path":"https://www.csids.no/cs9/reference/get_config_tasks_stats.html","id":null,"dir":"Reference","previous_headings":"","what":"Get Configuration Tasks Statistics — get_config_tasks_stats","title":"Get Configuration Tasks Statistics — get_config_tasks_stats","text":"Retrieves runtime statistics performance metrics surveillance tasks configuration database.","code":""},{"path":"https://www.csids.no/cs9/reference/get_config_tasks_stats.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get Configuration Tasks Statistics — get_config_tasks_stats","text":"","code":"get_config_tasks_stats(task = NULL, last_run = FALSE)"},{"path":"https://www.csids.no/cs9/reference/get_config_tasks_stats.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get Configuration Tasks Statistics — get_config_tasks_stats","text":"task Character string specifying task name filter . NULL, returns statistics tasks. last_run Logical value indicating whether return recent run statistics. FALSE, returns historical data.","code":""},{"path":"https://www.csids.no/cs9/reference/get_config_tasks_stats.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get Configuration Tasks Statistics — get_config_tasks_stats","text":"data.table containing task statistics columns including: task, datetime, runtime_seconds, memory_usage, status, metrics","code":""},{"path":"https://www.csids.no/cs9/reference/get_config_tasks_stats.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get Configuration Tasks Statistics — get_config_tasks_stats","text":"","code":"if (FALSE) { # \\dontrun{ # Get all task statistics get_config_tasks_stats()  # Get statistics for a specific task get_config_tasks_stats(task = \"covid_analysis\")  # Get only the last run for a task get_config_tasks_stats(task = \"covid_analysis\", last_run = TRUE) } # }"},{"path":"https://www.csids.no/cs9/reference/mandatory_db_filter.html","id":null,"dir":"Reference","previous_headings":"","what":"mandatory_db_filter — mandatory_db_filter","title":"mandatory_db_filter — mandatory_db_filter","text":"mandatory_db_filter","code":""},{"path":"https://www.csids.no/cs9/reference/mandatory_db_filter.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"mandatory_db_filter — mandatory_db_filter","text":"","code":"mandatory_db_filter(   .data,   granularity_time = NULL,   granularity_time_not = NULL,   granularity_geo = NULL,   granularity_geo_not = NULL,   country_iso3 = NULL,   location_code = NULL,   age = NULL,   age_not = NULL,   sex = NULL,   sex_not = NULL )"},{"path":"https://www.csids.no/cs9/reference/mandatory_db_filter.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"mandatory_db_filter — mandatory_db_filter","text":".data Data granularity_time Granularity time filter (include) granularity_time_not Granularity time filter (exclude) granularity_geo Granularity geo filter (include) granularity_geo_not Granularity geo filter (exclude) country_iso3 country_iso3 filter (include) location_code location_code filter (include) age Age filter (include) age_not Age filter (exclude) sex Sex filter (include) sex_not Sex filter (exclude)","code":""},{"path":"https://www.csids.no/cs9/reference/path.html","id":null,"dir":"Reference","previous_headings":"","what":"Get Results Folder Path — path","title":"Get Results Folder Path — path","text":"Constructs appropriate folder path surveillance system results, automatic switching production interactive modes.","code":""},{"path":"https://www.csids.no/cs9/reference/path.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get Results Folder Path — path","text":"","code":"path(   ...,   create_dir = FALSE,   trailing_slash = FALSE,   auto = cs9::config$is_auto )"},{"path":"https://www.csids.no/cs9/reference/path.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get Results Folder Path — path","text":"... Character strings specifying second level directory beyond create_dir Logical value indicating whether create directory exist. Defaults FALSE. trailing_slash Logical value indicating whether add trailing slash returned path. Defaults FALSE. auto Logical value indicating whether running automatic mode (uses base directory) interactive mode (adds \"_interactive\" subdirectory). Defaults current cs9::config$is_auto setting.","code":""},{"path":"https://www.csids.no/cs9/reference/path.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get Results Folder Path — path","text":"Character string containing constructed file path","code":""},{"path":"https://www.csids.no/cs9/reference/path.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get Results Folder Path — path","text":"","code":"if (FALSE) { # \\dontrun{ # Get basic output path path(\"reports\", \"daily\")  # Create directory if it doesn't exist path(\"reports\", \"daily\", create_dir = TRUE)  # Get path with trailing slash path(\"reports\", \"daily\", trailing_slash = TRUE) } # }"},{"path":"https://www.csids.no/cs9/reference/reexports.html","id":null,"dir":"Reference","previous_headings":"","what":"Objects exported from other packages — reexports","title":"Objects exported from other packages — reexports","text":"objects imported packages. Follow links see documentation. magrittr %>%","code":""},{"path":"https://www.csids.no/cs9/reference/run_task_sequentially_as_rstudio_job_using_load_all.html","id":null,"dir":"Reference","previous_headings":"","what":"Run a Task Sequentially as an RStudio Job — run_task_sequentially_as_rstudio_job_using_load_all","title":"Run a Task Sequentially as an RStudio Job — run_task_sequentially_as_rstudio_job_using_load_all","text":"Executes surveillance task RStudio job using devtools::load_all() package development. function creates temporary R script loads package runs specified task sequentially (cores = 1).","code":""},{"path":"https://www.csids.no/cs9/reference/run_task_sequentially_as_rstudio_job_using_load_all.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run a Task Sequentially as an RStudio Job — run_task_sequentially_as_rstudio_job_using_load_all","text":"","code":"run_task_sequentially_as_rstudio_job_using_load_all(   task_name,   ss_prefix = \"global$ss\" )"},{"path":"https://www.csids.no/cs9/reference/run_task_sequentially_as_rstudio_job_using_load_all.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run a Task Sequentially as an RStudio Job — run_task_sequentially_as_rstudio_job_using_load_all","text":"task_name Character string specifying name task run ss_prefix Character string specifying prefix used access surveillance system object. Defaults \"global$ss\"","code":""},{"path":"https://www.csids.no/cs9/reference/run_task_sequentially_as_rstudio_job_using_load_all.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run a Task Sequentially as an RStudio Job — run_task_sequentially_as_rstudio_job_using_load_all","text":"return value. function called side effect launching RStudio job executes surveillance task.","code":""},{"path":"https://www.csids.no/cs9/reference/run_task_sequentially_as_rstudio_job_using_load_all.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Run a Task Sequentially as an RStudio Job — run_task_sequentially_as_rstudio_job_using_load_all","text":"function primarily used package development test tasks interactively. creates temporary R script : Loads package using devtools::load_all() Sets task run single core (cores = 1) Executes task via surveillance system","code":""},{"path":"https://www.csids.no/cs9/reference/run_task_sequentially_as_rstudio_job_using_load_all.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Run a Task Sequentially as an RStudio Job — run_task_sequentially_as_rstudio_job_using_load_all","text":"","code":"if (FALSE) { # \\dontrun{ # Run a task as RStudio job during development run_task_sequentially_as_rstudio_job_using_load_all(\"covid_analysis\")  # Use custom surveillance system prefix run_task_sequentially_as_rstudio_job_using_load_all(   \"covid_analysis\",    ss_prefix = \"my_ss\" ) } # }"},{"path":"https://www.csids.no/cs9/reference/update_config_log.html","id":null,"dir":"Reference","previous_headings":"","what":"Update Configuration Log — update_config_log","title":"Update Configuration Log — update_config_log","text":"Logs configuration updates relevant metadata timestamp, session state, task name, custom message. function inserts log entry config_log table current configuration.","code":""},{"path":"https://www.csids.no/cs9/reference/update_config_log.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Update Configuration Log — update_config_log","text":"","code":"update_config_log(ss = \"unspecified\", task = \"unspecified\", ...)"},{"path":"https://www.csids.no/cs9/reference/update_config_log.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Update Configuration Log — update_config_log","text":"ss Character. Surveillance system identifier. Defaults \"unspecified\". task Character. Name task logged. Defaults \"unspecified\". ... Character. Custom message describing log entry. Must NULL.","code":""},{"path":"https://www.csids.no/cs9/reference/update_config_log.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Update Configuration Log — update_config_log","text":"return value; function called side effect inserting log entry config_log table.","code":""},{"path":"https://www.csids.no/cs9/reference/update_config_log.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Update Configuration Log — update_config_log","text":"function records type interaction (automatic interactive), session state, task description, user-provided message configuration log. throws error message argument NULL.","code":""},{"path":"https://www.csids.no/cs9/reference/update_config_log.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Update Configuration Log — update_config_log","text":"","code":"if (FALSE) { # \\dontrun{ update_config_log(ss = \"weather\", task = \"data_import\", message = \"Imported dataset successfully.\") } # }"},{"path":[]},{"path":"https://www.csids.no/cs9/news/index.html","id":"documentation-25-8-21","dir":"Changelog","previous_headings":"","what":"Documentation","title":"Version 25.8.21","text":"Organized pkgdown reference documentation logical function groupings Enhanced reference structure clear categories different types functions Improved pkgdown configuration better navigation package documentation","code":""},{"path":[]},{"path":"https://www.csids.no/cs9/news/index.html","id":"new-features-25-7-31","dir":"Changelog","previous_headings":"","what":"New Features","title":"Version 25.7.31","text":"Enhanced environment variable validation detailed diagnostic function check_environment_setup() Improved graceful degradation CRAN compatibility - package loads limited functionality database infrastructure available Context-aware environment variable validation clear user guidance Robust error handling package loading process","code":""},{"path":"https://www.csids.no/cs9/news/index.html","id":"improvements-25-7-31","dir":"Changelog","previous_headings":"","what":"Improvements","title":"Version 25.7.31","text":"Updated system environment configuration handling Comprehensive startup messages guide users configuration issues Enhanced database connection error handling Improved package loading sequence better error isolation","code":""},{"path":"https://www.csids.no/cs9/news/index.html","id":"documentation-25-7-31","dir":"Changelog","previous_headings":"","what":"Documentation","title":"Version 25.7.31","text":"Comprehensive installation vignette explaining infrastructure requirements Enhanced function documentation CRAN-compatible examples Clear guidance functionality available different deployment scenarios Added comprehensive package-level documentation (?cs9) Enhanced check_environment_setup() documentation detailed examples Updated vignettes CRAN vs. full setup guidance","code":""},{"path":"https://www.csids.no/cs9/news/index.html","id":"cran-preparation-25-7-31","dir":"Changelog","previous_headings":"","what":"CRAN Preparation","title":"Version 25.7.31","text":"Removed fhiplot dependency (replaced standard R functions) Fixed non-portable file names vignettes directory Cleaned build artifacts hidden files Updated LICENSE file copyright year 2025 Created vignette precompiler system maintainable documentation Verified graceful degradation minimal environments","code":""},{"path":"https://www.csids.no/cs9/news/index.html","id":"bug-fixes-25-7-31","dir":"Changelog","previous_headings":"","what":"Bug Fixes","title":"Version 25.7.31","text":"Fixed package loading issues environments without database configuration Improved error messages missing environment variables Enhanced database table setup error handling","code":""},{"path":"https://www.csids.no/cs9/news/index.html","id":"version-202536","dir":"Changelog","previous_headings":"","what":"Version 2025.3.6","title":"Version 2025.3.6","text":"Automatically logging tasks start running.","code":""},{"path":[]},{"path":"https://www.csids.no/cs9/news/index.html","id":"new-features-2025-2-24","dir":"Changelog","previous_headings":"","what":"New Features","title":"Version 2025.2.24","text":"Supports optional filtering surveillance system (ss), task name (task), date range (start_date, end_date). Returns data.table filtered entries.","code":""},{"path":"https://www.csids.no/cs9/news/index.html","id":"improvements-2025-2-24","dir":"Changelog","previous_headings":"","what":"Improvements","title":"Version 2025.2.24","text":"Updated update_config_log() also route custom messages (...) message() function clearer console output.","code":""},{"path":"https://www.csids.no/cs9/news/index.html","id":"version-2025221","dir":"Changelog","previous_headings":"","what":"Version 2025.2.21","title":"Version 2025.2.21","text":"Added update_config_log function. Logs configuration updates including surveillance system (ss), task name (task), custom message.","code":""},{"path":"https://www.csids.no/cs9/news/index.html","id":"version-2024617","dir":"Changelog","previous_headings":"","what":"Version 2024.6.17","title":"Version 2024.6.17","text":"Allows CS9_DBCONFIG_ROLE_CREATE_TABLE environmental variables.","code":""},{"path":"https://www.csids.no/cs9/news/index.html","id":"version-2024617-1","dir":"Changelog","previous_headings":"","what":"Version 2024.6.17","title":"Version 2024.6.17","text":"running parallel, seed set according index first analysis plan.","code":""},{"path":"https://www.csids.no/cs9/news/index.html","id":"version-202466","dir":"Changelog","previous_headings":"","what":"Version 2024.6.6","title":"Version 2024.6.6","text":"Partition table names now ‘xxxpartitionxxx’ ‘PARTITION’","code":""},{"path":"https://www.csids.no/cs9/news/index.html","id":"version-202437","dir":"Changelog","previous_headings":"","what":"Version 2024.3.7","title":"Version 2024.3.7","text":"Including confirm_insert_via_nrow DBtables. Checks nrow() insert insert. nrow() increased sufficiently, attempt upsert.","code":""},{"path":"https://www.csids.no/cs9/news/index.html","id":"version-202381","dir":"Changelog","previous_headings":"","what":"Version 2023.8.1","title":"Version 2023.8.1","text":"cs9::path now uses _interactive instead interactive.","code":""},{"path":"https://www.csids.no/cs9/news/index.html","id":"version-202353","dir":"Changelog","previous_headings":"","what":"Version 2023.5.3","title":"Version 2023.5.3","text":"R 4.3.0 .character(lubridate::now()) adds microseconds, breaks SQL upload. now replaced cstime::now_c().","code":""},{"path":"https://www.csids.no/cs9/news/index.html","id":"version-2023414","dir":"Changelog","previous_headings":"","what":"Version 2023.4.14","title":"Version 2023.4.14","text":"Changed “success” “succeeded” update_config_tasks_stats","code":""},{"path":"https://www.csids.no/cs9/news/index.html","id":"version-2023413","dir":"Changelog","previous_headings":"","what":"Version 2023.4.13","title":"Version 2023.4.13","text":"DBPartitionedTableExtended_v9$info() bug fixed argument collapse=TRUE. Inclusion confirm_indexes DBPartitionedTableExtended_v9.","code":""},{"path":"https://www.csids.no/cs9/news/index.html","id":"version-2023412","dir":"Changelog","previous_headings":"","what":"Version 2023.4.12","title":"Version 2023.4.12","text":"DBPartitionedTableExtended_v9$nrow() now new argument collapse=FALSE provides partion-specific results DBPartitionedTableExtended_v9$info() now includes sizes MB","code":""},{"path":"https://www.csids.no/cs9/news/index.html","id":"version-202343","dir":"Changelog","previous_headings":"","what":"Version 2023.4.3","title":"Version 2023.4.3","text":"Bug fix DBPartitionedTableExtended_v9$nrow()","code":""},{"path":"https://www.csids.no/cs9/news/index.html","id":"version-202342","dir":"Changelog","previous_headings":"","what":"Version 2023.4.2","title":"Version 2023.4.2","text":"Extension DBPartitionedTableExtended_v9 easier use multiple partitioning variables.","code":""},{"path":"https://www.csids.no/cs9/news/index.html","id":"version-202341","dir":"Changelog","previous_headings":"","what":"Version 2023.4.1","title":"Version 2023.4.1","text":"Inclusion partitions_randomized DBPartitionedTableExtended_v9 running parallel, database tables don’t get locked. Inclusion remove_table DBPartitionedTableExtended_v9 Fixed error RAM calculation parallel get_config_tasks_stats","code":""},{"path":"https://www.csids.no/cs9/news/index.html","id":"version-2023331","dir":"Changelog","previous_headings":"","what":"Version 2023.3.31","title":"Version 2023.3.31","text":"DBTableExtended_v9 now automatically includes column tables, called auto_last_updated_datetime, automatically calculated time row changed. Creation DBPartitionedTableExtended_v9, allows one dataset partitioned amongst multiple SQL tables automatically.","code":""},{"path":"https://www.csids.no/cs9/news/index.html","id":"version-202338","dir":"Changelog","previous_headings":"","what":"Version 2023.3.8","title":"Version 2023.3.8","text":"SurveillanceSystem_v9 constructor now takes argument called implementation_version, can used identify version analytics code currently run. update_config_last_updated now replaced update_config_tables_last_updated (contains tables last updated) config_tasks_stats (contains runtimes tasks). SurveillanceSystem_v9 now uses internal R6 class DBTableExtended_v9 (extends csdb::DBTable_v9) instead using csdb::DBTable_v9 directly. DBTableExtended_v9 calls update_config_last_updated altering database table.","code":""},{"path":"https://www.csids.no/cs9/news/index.html","id":"version-202337","dir":"Changelog","previous_headings":"","what":"Version 2023.3.7","title":"Version 2023.3.7","text":"sc8 deprecated favor cs9.","code":""},{"path":"https://www.csids.no/cs9/news/index.html","id":"version-802","dir":"Changelog","previous_headings":"","what":"Version 8.0.2","title":"Version 8.0.2","text":"Allows multiple databases used different access levels. copy_into_new_table_where now also copies indexes. V8 schemas now nice print function. V8 redirects now nice print function. copy_into_new_table_where uses tablock. upsert_at_end_of_each_plan insert_at_end_of_each_plan can now take named lists return value action_fn. Custom progressr handler.","code":""},{"path":"https://www.csids.no/cs9/news/index.html","id":"version-801","dir":"Changelog","previous_headings":"","what":"Version 8.0.1","title":"Version 8.0.1","text":"using sc8::add_task_from_config_v8 schema list checked make sure actually schemas. solve issue people incorrectly add non-existent schemas task. insert_data, upsert_data, drop_all_rows_and_then_insert_data now recommended ways inserting data addin_load_production schemas now use load_folder_fn, dynamically check user permission write folder, solving permissions errors Including tm_get_schema_names granularity_time granularity_geo now included db censors Requires R >= 4.1.0 sc8::config$plan_attempt_index now exists. running plans parallel, plan fails retried five times. lets user track attempt . mostly useful emails smses sent sc8::config$plan_attempt_index==1 (Disabled) TABLOCK disabled right now due issues data uploaded. (Disabled) Data sorted sending bcp speed /upserts.","code":""},{"path":"https://www.csids.no/cs9/news/index.html","id":"version-800","dir":"Changelog","previous_headings":"","what":"Version 8.0.0","title":"Version 8.0.0","text":"Release schema redirects allow restricted anonymous datasets seamlessly used people different access rights Consistent naming task_from_config_v8 add_schema_v8","code":""},{"path":"https://www.csids.no/cs9/news/index.html","id":"version-714","dir":"Changelog","previous_headings":"","what":"Version 7.1.4","title":"Version 7.1.4","text":"db_insert_data, db_upsert_data, db_drop_all_rows_and_then_upsert_data now recommended ways inserting data","code":""},{"path":"https://www.csids.no/cs9/news/index.html","id":"version-713","dir":"Changelog","previous_headings":"","what":"Version 7.1.3","title":"Version 7.1.3","text":"update_config_datetime get_config_datetime now automatically record database table updates well","code":""},{"path":"https://www.csids.no/cs9/news/index.html","id":"version-712","dir":"Changelog","previous_headings":"","what":"Version 7.1.2","title":"Version 7.1.2","text":"Updating default db schemas explicit useage isotime.","code":""},{"path":"https://www.csids.no/cs9/news/index.html","id":"version-711","dir":"Changelog","previous_headings":"","what":"Version 7.1.1","title":"Version 7.1.1","text":"qsenc_save qsenc_read save/read /encrypted files.","code":""},{"path":"https://www.csids.no/cs9/news/index.html","id":"version-710","dir":"Changelog","previous_headings":"","what":"Version 7.1.0","title":"Version 7.1.0","text":"task_from_config_v3 sets new direction creation tasks management tasks describe_tasks describe_schemas help automatic documentation","code":""},{"path":"https://www.csids.no/cs9/news/index.html","id":"version-708","dir":"Changelog","previous_headings":"","what":"Version 7.0.8","title":"Version 7.0.8","text":"task_inline_v1 allows easy inline task creation Corresponding RStudio addin inline tasks copy one db table another","code":""},{"path":"https://www.csids.no/cs9/news/index.html","id":"version-707","dir":"Changelog","previous_headings":"","what":"Version 7.0.7","title":"Version 7.0.7","text":"copy_into_new_table_where allows creation new table old table Including task_from_config_v2 First RStudio addin","code":""},{"path":"https://www.csids.no/cs9/news/index.html","id":"version-706","dir":"Changelog","previous_headings":"","what":"Version 7.0.6","title":"Version 7.0.6","text":"write_data_infile now checks Infinite/NaN values sets NA","code":""},{"path":"https://www.csids.no/cs9/news/index.html","id":"version-705","dir":"Changelog","previous_headings":"","what":"Version 7.0.5","title":"Version 7.0.5","text":"Task now includes action_before_fn action_after_fn","code":""},{"path":"https://www.csids.no/cs9/news/index.html","id":"version-704","dir":"Changelog","previous_headings":"","what":"Version 7.0.4","title":"Version 7.0.4","text":"validator_field_contents_sykdomspulsen now allows baregion valid granularity_geo","code":""},{"path":"https://www.csids.no/cs9/news/index.html","id":"version-703","dir":"Changelog","previous_headings":"","what":"Version 7.0.3","title":"Version 7.0.3","text":"tm_get_plans_argsets_as_dt provides overview plans argsets within task","code":""},{"path":"https://www.csids.no/cs9/news/index.html","id":"version-702","dir":"Changelog","previous_headings":"","what":"Version 7.0.2","title":"Version 7.0.2","text":"keep_rows_where now also retains PK constraints","code":""}]
